<script>
    const weekday = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    const months = ["January", "February", "March", "April", "May", "June", "July", "August", "Septemeber", "October", "November", "December"];

    let date = new Date();
    let currDate = date.getDate();
    let currYear = date.getFullYear();
    let currMonth = date.getMonth();
    let test5 = new Date(currYear, currMonth + 1, 0);
    let serviceEnd = "";
    let serviceEnd1 = [];
    let stylist = "";
    let startTime = "";
    let bookedStylist = "";
    let stylistName = "";
    let duration = "0";
    let currentStylers = [];
    let total = "0.00";
    let servicesAvailable = [];
    let totalTime = 0;
    let multiService = [];
    test5.setUTCHours(23, 59, 59, 0);
    function checkAva(currTime, lastTime, serviceId, durationTotal) {
        // console.log(lastTime)
        if (stylistName) {
            $(".serviceList .multiServiceSide .multiServiceStylist").remove();
            $(".serviceList .multiServiceSide .stylist").append(`
      <div class='multiServiceStylist'>${stylistName}</div>
      `);
        }
        serviceEnd = serviceId;
        duration = durationTotal / 60000;
        let styleTest = [];
        serviceId.forEach((item) => {
            styleTest.push({
                serviceVariationId: item,
                teamMemberIdFilter: {
                    any: stylist,
                },
            });
        });
        fetch(`https://shp-webserver-temp.glitch.me/sq-availability`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                start: currTime,
                end: lastTime,
                styling: styleTest,
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                // multiService.push(r.availabilities);
                $(".botss .nextButton").unbind("click");
                $(".botss .backButton").unbind("click");
                $(".mobileBottom1 .bookingButton.confirmButton").unbind("click");
                if ($(".serviceList .serviceBooking").hasClass("active")) {
                    let apps = r.availabilities;
                    let dateSelected = new Date().toLocaleString("en-us", { weekday: "short" });
                    let firstDate = r.availabilities[0];
                    let v = 0;

                    // $('.calendarMain .loader2').addClass('non-active');
                    // $('.calendarTest .loader2').addClass('non-active');

                    if (apps.length > 0) {
                        $(".currMonth").removeClass("active selected");
                        apps.forEach((item) => {
                            const date = new Date(item.startAt);
                            const day = date.getDate();
                            Array.from($(".currMonth")).forEach((item1) => {
                                if (day == item1.innerHTML) {
                                    if (!item1.classList.contains("active")) {
                                        item1.setAttribute("data-id", v);
                                        $(item1).addClass("active");
                                        v++;
                                    }
                                }
                            });
                        });
                        $(".currMonth.active").eq(0).addClass("selected");
                        let x = $(".currMonth.selected").attr("data-id");
                        let y = $(".currMonth.selected").attr("data-date");
                        // calendarChange()
                        getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                        if ($(window).width() > 1023) {
                            $(".multiServiceDesk .calendarTop .prev-arrow").addClass("disabled");
                            $(".multiServiceDesk .calendarTop .next-arrow").removeClass("disabled");
                            $(".multiServiceDesk .calendarTop .next-arrow").on("click", nextMonth);
                        }
                    } else {
                        $(".currMonth").removeClass("active selected");
                        currMonth = currMonth + 1;
                        if (currMonth < 0 || currMonth > 11) {
                            date = new Date(currYear, currMonth);
                            currYear = date.getFullYear();
                            currMonth = date.getMonth();
                        } else {
                            date = new Date();
                        }
                        let test7 = new Date(currYear, currMonth + 1, 0);
                        let test8 = new Date(currYear, currMonth, 1);
                        $(".calendarTop .next-arrow").bind("click", nextMonth);

                        test7.setUTCHours(23, 59, 59, 0);
                        calendarChange();
                        bookingSq(test8.toISOString(), test7.toISOString(), serviceEnd, stylist);
                    }

                    $(".serviceList li.currMonth.active").on("click", function () {
                        $(".currMonth.active").removeClass("selected");
                        $(this).addClass("selected");
                        let x = this.getAttribute("data-id");
                        let y = this.getAttribute("data-date");
                        getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                    });
                }
                $(".mobileBottom1 .bookingButton.confirmButton").on("click", function () {
                    if (localStorage.getItem("email")) {
                        let x = [];
                        const vidutest = multiService[0].appointmentSegments.forEach((item) => {
                            x.push({
                                teamMemberId: item.teamMemberId,
                                durationMinutes: item.durationMinutes,
                                serviceVariationId: item.serviceVariationId,
                                serviceVariationVersion: item.serviceVariationVersion,
                            });
                        });
                        $(".mobileBottom1 .bookingButton.confirmButton").addClass("loading");
                        createBooking(localStorage.getItem("customerId"), x, ".serviceList", localStorage.getItem("customerId"));
                    } else {
                        $(".confirmButton").addClass("non-active");
                        $(".bookNowButton").addClass("active");
                        $(".bookingConfirm").removeClass("active");
                        // $('.bookingForm').addClass('active');
                        $(".form1234").empty().append($(".bookingForm").eq(0).clone().addClass("active"));
                        $(".form1234 .bookingForm input[type=submit]").attr("id", "submit-form2");

                        $(".bookingLoad:not(.loaded):first").addClass("loaded");

                        $(".form1234 #myForm1").on("submit", function (e) {
                            e.preventDefault();
                            const serv = multiService[0];
                            let x = [];
                            const vidutest = serv.appointmentSegments.forEach((item) => {
                                x.push({
                                    teamMemberId: item.teamMemberId,
                                    durationMinutes: item.durationMinutes,
                                    serviceVariationId: item.serviceVariationId,
                                    serviceVariationVersion: item.serviceVariationVersion,
                                });
                            });
                            if ($("#myForm1 [name='firstName']").val().trim().length == 0) {
                                document.querySelector("#myForm1 [name='firstName']").setCustomValidity("Please fill in your first name");
                                document.querySelector("#myForm1 [name='firstName']").reportValidity();
                            } else if ($("#myForm1 [name='lastName']").val().trim().length == 0) {
                                document.querySelector("#myForm1 [name='lastName']").setCustomValidity("Please fill in your last name");
                                document.querySelector("#myForm1 [name='lastName']").reportValidity();
                            } else if (
                                $("#myForm1 [name='email']").val().trim().length == 0 ||
                                $("#myForm1 [name='email']")
                                    .val()
                                    .match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g) == null
                            ) {
                                document.querySelector("#myForm1 [name='email']").setCustomValidity("Please fill in correct email format, i.e example@example.com");
                                document.querySelector("#myForm1 [name='email']").reportValidity();
                            } else if (
                                $("#myForm1 [name='number']").val().trim().length == 0 ||
                                $("#myForm1 [name='number']")
                                    .val()
                                    .match(/^[+]*[1]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g) == null
                            ) {
                                document.querySelector("#myForm1 [name='number']").setCustomValidity("Please fill in correct phone number format, i.e 0123456789");
                                document.querySelector("#myForm1 [name='number']").reportValidity();
                            } else {
                                $(".bookNowButton").addClass("loading");
                                $("#myForm1 input").prop("disabled", true);
                                $("#myForm1 select").prop("disabled", true);
                                $("#myForm1 textarea").prop("disabled", true);
                                $("#myForm1 button").prop("disabled", true);
                                $(".mobilePopup .bookNowButton").addClass("loading");
                                fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
                                    method: "POST",
                                    headers: {
                                        accept: "application/json",
                                        "content-type": "application/json",
                                    },
                                    body: JSON.stringify({
                                        email: $("#myForm1 input[name=email]").val(),
                                    }),
                                })
                                    .then((r) => r.json())
                                    .then((r) => {
                                        if (jQuery.isEmptyObject(r)) {
                                            createCustomer(x, "#myForm1");
                                        } else {
                                            $(".accExistsOverlay1").removeClass("non-active");
                                            // $('.accExistsOverlay').removeClass('non-active');
                                            $(".accExistsOverlay1 .bookingButton").on("click", function () {
                                                $(".newClients").addClass("non-active");
                                                $(".oldClients").removeClass("non-active");
                                                $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                                                $(".mobilePopup").css("max-height", "0px");
                                                $(".accExistsOverlay1").addClass("non-active");
                                                $(".serviceList").css("max-height", "0px");
                                                $(".loader2").removeClass("non-active");
                                                $(".squareuplogin #loginForm").on("submit", checkCustomer);
                                                localStorage.setItem("savedBooking", "savedBooking");
                                            });
                                        }
                                    });
                            }

                            // $("button").prop("disabled", "disabled");
                            // $(".e-submit .e-content input").prop("readonly", true);
                            // $("button[type=submit]").html(`<img src="/content/images/common/loading.svg" width="20px" height="20px"/>`)
                        });
                    }
                });

                $(".botss .backButton").on("click", function () {
                    if ($(".form1234 .serviceBooking").hasClass("active")) {
                        $(".bookingLoad.loaded:last").removeClass("loaded");

                        $(".form1234").empty();
                        $(".gokutest").removeClass("non-active");
                        $(".service").removeClass("non-active");
                        $(".total").removeClass("non-active");
                        startTime = "";
                        currMonth = new Date().getMonth();
                        calendarChange();
                    } else if ($(".form1234 .bookingConfirm").hasClass("active")) {
                        $(".serviceBooking .calendarTest .loader2").removeClass("non-active");
                        startTime = "";
                        $(".bookingLoad.loaded:last").removeClass("loaded");
                        $(".form1234").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                        $(".form1234 .serviceBooking").prepend($(".staffBooking").eq(0).clone().addClass("active"));

                        $(".form1234 .calendarTop .prev-arrow").addClass("disabled");
                        $(".form1234 .calendarTop .next-arrow").removeClass("disabled");
                        $(".currMonth.active").eq(0).addClass("selected");
                        $(".botss .confirmButton").addClass("non-active");
                        $(".botss .nextButton").removeClass("non-active");
                        let x = $(".currMonth.selected").attr("data-id");
                        let y = $(".currMonth.selected").attr("data-date");
                        $(".form1234 .calendarTop .prev-arrow").on("click", prevMonth);
                        $(".form1234 .calendarTop .next-arrow").on("click", nextMonth);
                        let date1 = new Date();
                        let year = date1.getFullYear();
                        let mon = date1.getMonth();
                        let test5 = new Date(year, mon + 1, 0);
                        test5.setUTCHours(23, 59, 59, 0);
                        currMonth = new Date().getMonth();

                        calendarChange();
                        // getCurrentDateAppointments(r.availabilities[x], r.availabilities, x, y)
                        bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);

                        let apps = r.availabilities;
                        let dateSelected = new Date().toLocaleString("en-us", { weekday: "short" });
                        let firstDate = r.availabilities[0];
                        let v = 0;
                        if (apps.length > 0) {
                            $(".currMonth").removeClass("active selected");
                            apps.forEach((item) => {
                                const date = new Date(item.startAt);
                                const day = date.getDate();
                                Array.from($(".currMonth")).forEach((item1) => {
                                    if (day == item1.innerHTML) {
                                        if (!item1.classList.contains("active")) {
                                            item1.setAttribute("data-id", v);
                                            $(item1).addClass("active");
                                            v++;
                                        }
                                    }
                                });
                            });
                            $(".currMonth.active").eq(0).addClass("selected");
                            let x = $(".currMonth.selected").attr("data-id");
                            let y = $(".currMonth.selected").attr("data-date");
                            // calendarChange()

                            getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                        }
                        $(".staffMembers .addNames1").on("click", function () {
                            duration = "";
                            startTime = "";
                            multiService = [];
                            bookedStylist = "";
                            // $('.calendarMain .loader2').removeClass('non-active');
                            $(".calendarTest .loader2").removeClass("non-active");

                            $(".morning .slot").empty();
                            $(".afternoon .slot").empty();
                            $(".evening .slot").empty();

                            if ($(".pleaseSelect").children.length > 0) {
                                $(".pleaseSelect").empty();
                            }

                            let memberId = $(this).data("team-member-id");
                            stylistName = $(this).data("team-member-name");

                            stylist = memberId.split(",");
                            $(".staffMembers .addNames1").removeClass("loaded");
                            $(this).addClass("loaded");
                            let date1 = new Date();
                            let year = date1.getFullYear();
                            let mon = date1.getMonth();
                            let test5 = new Date(year, mon + 1, 0);
                            test5.setUTCHours(23, 59, 59, 0);
                            currMonth = new Date().getMonth();
                            calendarChange();
                            bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                            $(".form1234 .calendarTop .prev-arrow").addClass("disabled");
                            $(".form1234 .calendarTop .next-arrow").removeClass("disabled");
                        });
                        $(".form1234 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        $(".form1234 .staffMembers div:first").removeClass("loaded");
                    } else if ($(".form1234 .bookingForm").hasClass("active")) {
                        $(".form1234").empty().append($(".bookingConfirm").eq(0).clone().addClass("active"));
                        $(".botss .bookNowButton").removeClass("active");
                        $(".botss .confirmButton").removeClass("non-active");
                    } else if (!$(".gokutest").hasClass("non-active")) {
                        $(".serviceList").css("max-height", `0px`);
                        $(".list-item").removeClass("active");
                        $(".service").empty();
                        $(".total").addClass("non-active");
                        $(".total").removeClass("active");
                        $(".page-test1").empty();
                        totalTime = 0;
                        total = "0.00";
                        serviceEnd1 = [];
                        serviceEnd = [];
                        $(".botss .nextButton").unbind("click");
                        $(".page-button").removeClass("page-button1");
                        $(".page-test").removeClass("brand-add");
                        $(".page-test").css("max-height", "0px");
                    }
                });
                $(".botss .nextButton").on("click", function () {
                    if (localStorage.getItem("email")) {
                        $(".serviceBooking .apptNote").removeClass("non-active");
                    } else {
                        $(".serviceBooking .apptNote").addClass("non-active");
                    }
                    if ($(".serviceBooking").hasClass("active")) {
                        if ((serviceEnd, bookedStylist, startTime)) {
                            let value = $(".serviceBooking .apptNote").val();
                            $(".serviceBooking").removeClass("active");
                            $(".staffBooking").removeClass("active");
                            $(".bookingLoad:not(.loaded):first").addClass("loaded");
                            serviceType1(serviceId, bookedStylist, startTime, value);
                        } else {
                            $(".pleaseSelect").html('<div style="text-align: center; color: red; padding-bottom: 10px;">Please select a timing</div>');
                        }
                    } else {
                        $(".form1234").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                        if (!$(".serviceBooking .staffBooking").hasClass("active")) {
                            $(".serviceBooking").prepend($(".staffBooking").eq(0).clone().addClass("active"));
                        }
                        $(".form1234 .calendarTop .prev-arrow").addClass("disabled");
                        $(".form1234 .calendarTop .next-arrow").removeClass("disabled");
                        $(".form1234 .calendarTop .next-arrow").on("click", nextMonth);
                        $(".staffMembers .addNames1").on("click", function () {
                            duration = "";
                            startTime = "";
                            multiService = [];
                            bookedStylist = "";
                            // $('.calendarMain .loader2').removeClass('non-active');
                            $(".calendarTest .loader2").removeClass("non-active");

                            $(".morning .slot").empty();
                            $(".afternoon .slot").empty();
                            $(".evening .slot").empty();

                            if ($(".pleaseSelect").children.length > 0) {
                                $(".pleaseSelect").empty();
                            }

                            let memberId = $(this).data("team-member-id");
                            stylistName = $(this).data("team-member-name");

                            stylist = memberId.split(",");
                            $(".staffMembers .addNames1").removeClass("loaded");
                            $(this).addClass("loaded");
                            let date1 = new Date();
                            let year = date1.getFullYear();
                            let mon = date1.getMonth();
                            let test5 = new Date(year, mon + 1, 0);
                            test5.setUTCHours(23, 59, 59, 0);
                            currMonth = new Date().getMonth();
                            calendarChange();
                            bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                            $(".form1234 .calendarTop .prev-arrow").addClass("disabled");
                            $(".form1234 .calendarTop .next-arrow").removeClass("disabled");
                        });
                        $(".gokutest").addClass("non-active");
                        $(".bookingLoad:not(.loaded):first").addClass("loaded");
                        if ($(".gokutest").hasClass("non-active")) {
                            $(".mobileBottom1 .botss .service").addClass("non-active");
                            $(".mobileBottom1 .botss .total").removeClass("active");
                            $(".mobileBottom1 .botss .total").addClass("non-active");
                        } else {
                            $(".mobileBottom1 .botss .service").removeClass("non-active");
                            $(".mobileBottom1 .botss .total").addClass("active");
                        }
                        let apps = r.availabilities;
                        let dateSelected = new Date().toLocaleString("en-us", { weekday: "short" });
                        let firstDate = r.availabilities[0];
                        let v = 0;
                        if (apps.length > 0) {
                            $(".currMonth").removeClass("active selected");
                            apps.forEach((item) => {
                                const date = new Date(item.startAt);
                                const day = date.getDate();
                                Array.from($(".currMonth")).forEach((item1) => {
                                    if (day == item1.innerHTML) {
                                        if (!item1.classList.contains("active")) {
                                            item1.setAttribute("data-id", v);
                                            $(item1).addClass("active");
                                            v++;
                                        }
                                    }
                                });
                            });
                            $(".currMonth.active").eq(0).addClass("selected");
                            let x = $(".currMonth.selected").attr("data-id");
                            let y = $(".currMonth.selected").attr("data-date");
                            // calendarChange()

                            getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                        } else {
                            $(".currMonth").removeClass("active selected");
                            currMonth = currMonth + 1;
                            if (currMonth < 0 || currMonth > 11) {
                                date = new Date(currYear, currMonth);
                                currYear = date.getFullYear();
                                currMonth = date.getMonth();
                            } else {
                                date = new Date();
                            }
                            let test7 = new Date(currYear, currMonth + 1, 0);
                            let test8 = new Date(currYear, currMonth, 1);
                            test7.setUTCHours(23, 59, 59, 0);
                            calendarChange();
                            bookingSq(test8.toISOString(), test7.toISOString(), serviceEnd, stylist);
                        }

                        $("li.currMonth.active").on("click", function () {
                            $(".currMonth.active").removeClass("selected");
                            $(this).addClass("selected");
                            let x = this.getAttribute("data-id");
                            let y = this.getAttribute("data-date");
                            getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                        });
                    }
                });
            });
    }
    function nextMonth() {
        duration = "";
        startTime = "";
        multiService = [];
        bookedStylist = "";
        currMonth = currMonth + 1;
        if (currMonth == new Date().getMonth() + 2) {
            $(".calendarTop .next-arrow").addClass("disabled");
            $(".calendarTop .next-arrow").unbind("click", nextMonth);
        }
        if (currMonth <= new Date().getMonth() + 2) {
            // $('.calendarMain .loader2').removeClass('non-active');
            $(".calendarTest .loader2").removeClass("non-active");

            $(".calendarTop .prev-arrow").removeClass("disabled");

            if (currMonth < 0 || currMonth > 11) {
                date = new Date(currYear, currMonth);
                currYear = date.getFullYear();
                currMonth = date.getMonth();
            } else {
                date = new Date();
            }
            let test5 = new Date(currYear, currMonth + 1, 0);
            let test6 = new Date(currYear, currMonth, 1);
            test5.setUTCHours(23, 59, 59, 0);
            calendarChange();
            bookingSq(test6.toISOString(), test5.toISOString(), serviceEnd, stylist);
        } else {
            currMonth = currMonth - 1;

            $(".calendarTop .next-arrow").unbind("click");
        }

        if (new Date().getMonth() < currMonth && new Date().getFullYear() >= currYear) {
            $(".calendarTop .prev-arrow").unbind("click");

            $(".calendarTop .prev-arrow").bind("click", prevMonth);
        }
    }
    function prevMonth() {
        duration = "";
        startTime = "";
        multiService = [];
        bookedStylist = "";

        if (new Date().getMonth() < currMonth && new Date().getFullYear() >= currYear) {
            // $('.calendarMain .loader2').removeClass('non-active');
            $(".calendarTest .loader2").removeClass("non-active");

            // $('.calendarTop .prev-arrow').bind('click', prevMonth)
            currMonth = currMonth - 1;

            if (currMonth == new Date().getMonth()) {
                $(".calendarTop .prev-arrow").addClass("disabled");
                $(".prev-arrow").unbind("click", prevMonth);
            } else {
                $(".next-arrow").bind("click", nextMonth);
            }
            if (currMonth < 0 || currMonth > 11) {
                date = new Date(currYear, currMonth, currDate);
                currYear = date.getFullYear();
                currMonth = date.getMonth();
            } else {
                date = new Date();
            }

            let test5 = new Date(currYear, currMonth + 1, 0);
            let test6 = new Date(currYear, currMonth, 1);
            if (currMonth === new Date().getMonth()) {
                bookingSq(new Date().toISOString(), test5.toISOString(), serviceEnd);
            } else {
                bookingSq(test6.toISOString(), test5.toISOString(), serviceEnd);
            }
            test5.setUTCHours(23, 59, 59, 0);
            calendarChange();
            // if (new Date().getMonth() < currMonth && new Date().getFullYear() >= currYear ) {
            //   $('.calendarTop .prev-arrow').unbind('click')
            $(".calendarTop .next-arrow").removeClass("disabled");
            // $('.calendarTop .next-arrow').bind('click', nextMonth)
            // }
        } else {
            $(".calendarTop .prev-arrow").addClass("disabled");
        }
    }
    function openFAQ(x) {
        let setheight = x.nextElementSibling.children[0].offsetHeight;
        let checkClass = x.nextElementSibling.classList;
        if (checkClass.contains("brand-add")) {
            checkClass.remove("brand-add");
            x.children[0].classList.remove("page-button1");
            x.nextElementSibling.style.maxHeight = "0";
        } else {
            checkClass.add("brand-add");
            x.children[0].classList.add("page-button1");
            x.nextElementSibling.style.maxHeight = setheight + "px";
        }
    }

    function calendarChange(x, y) {
        // console.log(currMonth)
        $("calendarMain .loader2").removeClass("non-active");

        let firstDayofMonth = new Date(currYear, currMonth, 1).getDay();
        let lastDateofMonth = new Date(currYear, currMonth + 1, 0).getDate();
        let lastDayofMonth = new Date(currYear, currMonth, lastDateofMonth).getDay();
        let lastDateofLastMonth = new Date(currYear, currMonth, 0).getDate();
        let checking = new Date().toLocaleDateString("fr-CA", { year: "numeric", month: "2-digit", day: "2-digit" });
        let change = "";
        for (let i = firstDayofMonth; i > 0; i--) {
            change += `<li class="inactive">${lastDateofLastMonth - i + 1}</li>`;
        }
        $(".calendarMonth").html(`
      ${months[currMonth]} ${currYear}
    `);

        for (let i = 1; i <= lastDateofMonth; i++) {
            let isToday = i === date.getDate() && currMonth === new Date().getMonth() && currYear === new Date().getFullYear() ? "currDay" : "";
            change += `
        <li data-date="${currYear}-${("0" + (currMonth + 1)).slice(-2)}-${("0" + i).slice(-2)}"  class="currMonth inactive ${isToday}">${i}</li>
      `;
        }
        for (let i = lastDayofMonth; i < 6; i++) {
            change += `<li class="inactive">${i - lastDayofMonth + 1}</li>`;
        }
        $("calendarMain .loader2").addClass("non-active");

        $(".calendarMain .days").html(`${change}`);
    }

    function getCurrentDateAppointments(firstDate, apps, x, y) {
        if (apps.length > 0) {
            // $('.serviceList .calendarMain .loader2').addClass('non-active')
            $(".serviceList .calendarTest .loader2").addClass("non-active");

            const test2 = apps.filter((item) => item.startAt.includes(y));
            let date = new Date(test2[0].startAt).toLocaleString("en-us", { day: "numeric", weekday: "short", year: "numeric" });
            let vidu1 = new Date(test2[0].startAt).toLocaleString("en-us", { weekday: "short" });
            let vidu2 = new Date(test2[0].startAt).toLocaleString("en-us", { day: "numeric" });
            let vidu4 = new Date(test2[0].startAt).toLocaleString("en-us", { year: "numeric" });
            let vidu3 = new Date(test2[0].startAt).toLocaleString("en-us", { month: "short" });
            let fullDate = `${vidu1}, ${vidu3} ${vidu2}, ${vidu4}`;
            $(".slot").empty();
            $(".slot2").removeClass("non-active");
            test2.forEach((item) => {
                const date = new Date(item.startAt);
                const time = date.toLocaleTimeString([], { hour: "numeric", minute: "2-digit" });
                const time2 = date.toLocaleTimeString("en-us", { hour12: false });

                if (time2 > "15:00:00") {
                    $(".evening .slot2").addClass("non-active");
                    $(".evening .slot").append(`<div data-start-id="${item.startAt}" data-duration="${duration}" data-team-member="${item.appointmentSegments[0].teamMemberId}" class="bookingButton1 bookBut">${time}</div>`);
                } else if (time2 > "12:00:00" && time2 <= "15:00:00") {
                    $(".afternoon .slot2").addClass("non-active");

                    $(".afternoon .slot").append(`<div data-start-id="${item.startAt}" data-duration="${duration}" data-team-member="${item.appointmentSegments[0].teamMemberId}" class="bookingButton1 bookBut">${time}</div>`);
                } else {
                    $(".morning .slot2").addClass("non-active");
                    $(".morning .slot").append(`<div data-start-id="${item.startAt}" data-duration="${duration}" data-team-member="${item.appointmentSegments[0].teamMemberId}" class="bookingButton1 bookBut">${time}</div>`);
                }
            });
            $(".dayAvailable").html(fullDate);
        } else {
        }
        $(".bookBut").on("click", function () {
            duration = $(this).data("duration");
            startTime = $(this).data("start-id");
            const test3 = apps.filter((item) => item.startAt.includes(y)).filter((item2) => item2.startAt == startTime);
            multiService = [];
            multiService.push(test3[0]);
            bookedStylist = $(this).data("team-member");
            localStorage.setItem("timeSelected", startTime);
            $(".bookBut").removeClass("active3");
            $(this).addClass("active3");
            if ($(".pleaseSelect").children.length > 0) {
                $(".pleaseSelect").empty();
            }
            if ($(window).width() > 1023) {
                if ($(".oldClients").hasClass("non-active") && !$(".newClients").hasClass("non-active")) {
                    $(".form123").scrollTop(0);
                    $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");

                    serviceType1(serviceEnd, stylist, startTime);
                    $(".form123").empty().append($(".bookingForm").eq(0).clone().addClass("active"));
                    $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                    $(".form123 #myForm1").on("submit", submitForm);

                    // $('.serviceBookingSide .loader2').addClass('non-active');
                } else {
                    // console.log('hi');
                    // console.log(serviceEnd);
                    // console.log(stylist);
                    // console.log(startTime);
                    serviceType1(serviceEnd, stylist, startTime);
                    Array.from($(".gokutest").children()).forEach((item) => {
                        $(item).css("display", "none");
                    });
                    $(".gokutest .desktopConfirmation").remove();
                    $(".gokutest").append($(".desktopConfirmation").eq(0).clone().addClass("active"));
                    $(".gokutest .desktopConfirmation .bookingButton").on("click", function () {
                        $(".gokutest .desktopConfirmation .bookingButton").addClass("loading");
                        setTimeout(function () {
                            // createBooking()
                            let x = [];
                            const vidutest = multiService[0].appointmentSegments.forEach((item) => {
                                x.push({
                                    teamMemberId: item.teamMemberId,
                                    durationMinutes: item.durationMinutes,
                                    serviceVariationId: item.serviceVariationId,
                                    serviceVariationVersion: item.serviceVariationVersion,
                                });
                            });
                            createBooking(localStorage.getItem("customerId"), x, ".serviceList", localStorage.getItem("customerId"));
                            $(".oldClients").addClass("active");
                        }, 1500);
                    });
                }
            }
        });

        // else {
        //   const test = apps.filter((item) => item === firstDate)
        // let date = new Date(apps[0].startAt).toLocaleString('en-us', { day: 'numeric',weekday: 'short' , year: 'numeric'})

        //   test.forEach((item) => {
        //     const date = new Date(item.startAt);
        //     const time = date.toLocaleTimeString([], {hour: 'numeric', minute:'2-digit'});
        //     const time2 = date.toLocaleTimeString('en-us', {hour12: false})

        //     if (time2 > '15:00:00') {
        //       $('.evening').append(`<div>${time}</div>`)
        //     } else if (time2 > "12:00:00" && time2 > '15:00:00') {
        //       $('.afternoon').append(`<div>${time}</div>`)
        //     } else {
        //       $('.morning').append(`<div class="bookingButton1 bookBut">${time}</div>`)

        //     }
        //   })
        //   $('.dayAvailable').html(date)
        // }
    }

    function bookingSq(startDate, endDate, service, stylists) {
        // console.log(startDate, endDate, service, stylists)
        serviceEnd = service;
        let styleTest = [];
        service.forEach((item) => {
            styleTest.push({
                serviceVariationId: item,
                teamMemberIdFilter: {
                    any: stylist,
                },
            });
        });

        fetch("https://shp-webserver-temp.glitch.me/sq-availability", {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                start: startDate,
                end: endDate,
                styling: styleTest,
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                let apps = r.availabilities;
                let dateSelected = new Date().toLocaleString("en-us", { weekday: "short" });

                // duration = firstDate.appointmentSegments[0].durationMinutes;
                let v = 0;
                if (apps.length > 0) {
                    let firstDate = r.availabilities[0];
                    duration = "0";
                    firstDate.appointmentSegments.forEach((item) => {
                        duration = parseFloat(duration) + parseFloat(item.durationMinutes);
                    });
                    $(".form123 .serviceBooking .sideBar .bookingTime").html(`${duration} minutes`);
                    $(".calendarTest .loader2").addClass("non-active");
                    $(".currMonth").removeClass("active selected");
                    apps.forEach((item) => {
                        const date = new Date(item.startAt);
                        const day = date.getDate();
                        Array.from($(".currMonth")).forEach((item1) => {
                            if (day == item1.innerHTML) {
                                if (!item1.classList.contains("active")) {
                                    item1.setAttribute("data-id", v);
                                    $(item1).addClass("active");
                                    v++;
                                }
                            }
                        });
                    });
                    if ($(".newClients").hasClass("non-active")) {
                        $(".serviceList .currMonth.active").eq(0).addClass("selected");
                    } else {
                        $(".currMonth.active").eq(0).addClass("selected");
                    }
                    let x = $(".currMonth.selected").attr("data-id");
                    let y = $(".currMonth.selected").attr("data-date");
                    // calendarChange()
                    getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                } else {
                    $(".currMonth").removeClass("active selected");
                    currMonth = currMonth + 1;
                    if (currMonth < 0 || currMonth > 11) {
                        date = new Date(currYear, currMonth);
                        currYear = date.getFullYear();
                        currMonth = date.getMonth();
                    } else {
                        date = new Date();
                    }
                    let test7 = new Date(currYear, currMonth + 1, 0);
                    let test8 = new Date(currYear, currMonth, 1);
                    test7.setUTCHours(23, 59, 59, 0);
                    $(".calendarTop .next-arrow").bind("click", nextMonth);
                    calendarChange();
                    bookingSq(test8.toISOString(), test7.toISOString(), serviceEnd, stylist);
                }

                $("li.currMonth.active").on("click", function () {
                    $(".currMonth.active").removeClass("selected");
                    $(this).addClass("selected");
                    let x = this.getAttribute("data-id");
                    let y = this.getAttribute("data-date");
                    // console.log(x)
                    // console.log(y)
                    // console.log(r.availabilities[x])
                    // console.log(r.availabilities)
                    getCurrentDateAppointments(r.availabilities[x], apps, x, y);
                });
            });
    }

    function addNames() {
        duration = "";
        startTime = "";
        multiService = [];
        bookedStylist = "";
        $(".calendarTest .loader2").removeClass("non-active");

        // $('.calendarMain .loader2').removeClass('non-active')
        $(".morning .slot").empty();
        $(".afternoon .slot").empty();
        $(".evening .slot").empty();
        if ($(".pleaseSelect").children.length > 0) {
            $(".pleaseSelect").empty();
        }
        let memberId = $(this).data("team-member-id");
        stylistName = $(this).data("team-member-name");
        stylist = memberId.split(",");
        $(".staffMembers .addNames1").removeClass("loaded");
        $(this).addClass("loaded");
        let date1 = new Date();
        let year = date1.getFullYear();
        let mon = date1.getMonth();
        let test5 = new Date(year, mon + 1, 0);
        test5.setUTCHours(23, 59, 59, 0);
        currMonth = new Date().getMonth();
        calendarChange();
        bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
        $(".form123 .calendarTop .next-arrow").removeClass("disabled");
        $(".form123 .calendarTop .prev-arrow").addClass("disabled");
    }

    function addNames1() {
        duration = "";
        startTime = "";
        multiService = [];
        bookedStylist = "";
        let lastTime = new Date(currYear, currMonth + 1, 0, 23, 59, 59);
        let currTime = date;
        let vidu = Math.abs(lastTime - currTime) / 36e5;
        if (vidu < 24) {
            lastTime = new Date(currYear, currMonth + 2, 0, 23, 59, 59);
        }
        if ($(".gokutest .multiServiceDesk")) {
            $(".multiServiceDesk1 .staffBooking").removeClass("active");
            $(".multiServiceDesk1").append($(".serviceBooking").eq(0).clone().addClass("active"));
        }

        let memberId = $(this).data("team-member-id");
        stylist = memberId.split(",");
        stylistName = $(this).data("team-member-name");

        $(".staffMembers .addNames1").removeClass("loaded");
        $(this).addClass("loaded");

        checkAva(currTime, lastTime, serviceEnd1, totalTime);
    }

    function addNames2() {
        duration = "";
        startTime = "";
        multiService = [];
        bookedStylist = "";
        // $('.calendarMain .loader2').removeClass('non-active');
        $(".calendarTest .loader2").removeClass("non-active");

        $(".morning .slot").empty();
        $(".afternoon .slot").empty();
        $(".evening .slot").empty();
        if ($(".pleaseSelect").children.length > 0) {
            $(".pleaseSelect").empty();
        }
        let memberId = $(this).data("team-member-id");
        stylistName = $(this).data("team-member-name");
        stylist = memberId.split(",");
        $(".staffMembers .addNames1").removeClass("loaded");
        $(this).addClass("loaded");
        let date1 = new Date();
        let year = date1.getFullYear();
        let mon = date1.getMonth();
        let test5 = new Date(year, mon + 1, 0);
        test5.setUTCHours(23, 59, 59, 0);
        if ($()) bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
    }

    function addNames3() {
      if ($(window).width() > 1023) {
                            $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                        }
                        duration = "";
                        startTime = "";
                        multiService = [];
                        bookedStylist = "";
                        // $('.calendarMain .loader2').removeClass('non-active')
                        $(".calendarTest .loader2").removeClass("non-active");
                        $(".morning .slot").empty();
                        $(".afternoon .slot").empty();
                        $(".evening .slot").empty();

                        if ($(".pleaseSelect").children.length > 0) {
                            $(".pleaseSelect").empty();
                        }

                        let memberId = $(this).data("team-member-id");
                        stylistName = $(this).data("team-member-name");
                        stylist = memberId.split(",");
                        $(".staffMembers .addNames1").removeClass("loaded");
                        $(this).addClass("loaded");
                        let date1 = new Date();
                        let year = date1.getFullYear();
                        let mon = date1.getMonth();
                        let test5 = new Date(year, mon + 1, 0);
                        test5.setUTCHours(23, 59, 59, 0);
                        currMonth = new Date().getMonth();
                        calendarChange();
                        bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                        $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                        $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                        if ($(window).width() > 1023) {
                            serviceType1(serviceEnd, stylist);
                            $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                            $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                            $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                        }
    }
    function serviceType1(serviceEnd, stylist, startTime, note) {
        fetch(`https://shp-webserver-temp.glitch.me/sq-servicetype`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
        })
            .then((r) => r.json())
            .then((r) => {
                // $('.mobileBottom1 .bookingButton').html('Confirm')
                $(".nextButton").addClass("non-active");
                $(".nextButton").removeClass("active");
                $(".confirmButton").removeClass("non-active");
                $("#serviceType").empty();
                if (localStorage.getItem("email") && !$(".oldClients").hasClass("non-active")) {
                    $("#apptNotes").empty().append(note);
                    $(".bookingConfirm .notes").removeClass("non-active");
                }
                serviceEnd.forEach((serv1) => {
                    r.items.forEach((item) => {
                        if (item.itemData.variations[0].id == serv1) {
                            currentStylers.forEach((item2) => {
                                if (stylist == item2.team_member_id) {
                                    stylistName = item2.display_name;
                                    if ($(".oldClients").hasClass("non-active")) {
                                        $("#stylistName").html(item2.display_name);
                                    } else {
                                        $("#stylistName").html(item2.display_name);
                                    }
                                }
                            });
                            if ($(".oldClients").hasClass("non-active")) {
                                $("#serviceType").empty();
                                $("#serviceType").append(`
            <div>
              ${item.itemData.name} (${item.itemData.variations[0].itemVariationData.serviceDuration / 60000}mins) </br>
              <p>${item.itemData.variations[0].itemVariationData.priceMoney ? `$` + item.itemData.variations[0].itemVariationData.priceMoney.amount / 100 + `.00` : "Price Varies"}</p>
              </div>
            `);
                            } else {
                                console.log(item);
                                $("#serviceType").append(`
            <div>
              ${item.itemData.name} (${item.itemData.variations[0].itemVariationData.serviceDuration / 60000}mins) </br>
              <p>${item.itemData.variations[0].itemVariationData.priceMoney ? `$` + item.itemData.variations[0].itemVariationData.priceMoney.amount / 100 + `.00` : "Price Varies"}</p>
              </div>
            `);
                            }

                            if ($(window).width() < 1024) {
                                let durationMins = new Date(startTime);
                                let day = new Date(startTime).getDay();
                                let date = new Date(startTime).getDate();
                                let month = new Date(startTime).getMonth();
                                let year = new Date(startTime).getFullYear();
                                let time = new Date(startTime).toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
                                let startTime2 = durationMins.setMinutes(durationMins.getMinutes() + duration);
                                let time2 = new Date(startTime2).toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
                                // $('.bookingConfirm .loader2').addClass('non-active');
                                if ($(".oldClients").hasClass("non-active")) {
                                    $("#dateSelected").html(`${weekday[day]},</br> ${months[month]} ${date}, ${year} </br> ${time} - ${time2} EST`);
                                    $(".form123").empty().append($(".bookingConfirm").eq(0).clone().addClass("active"));
                                    $(".bookingConfirm .loader2").addClass("non-active");
                                } else {
                                    $("#dateSelected").html(`${weekday[day]},</br> ${months[month]} ${date}, ${year} </br> ${time} - ${time2} EST`);
                                    $(".bookingConfirm .loader2").addClass("non-active");
                                }
                            } else {
                                let durationMins = new Date(startTime);
                                let day = new Date(startTime).getDay();
                                let date = new Date(startTime).getDate();
                                let month = new Date(startTime).getMonth();
                                let year = new Date(startTime).getFullYear();
                                let time = new Date(startTime).toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
                                let startTime2 = durationMins.setMinutes(durationMins.getMinutes() + duration);
                                let time2 = new Date(startTime2).toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });

                                if ($(window).width() > 1023 && $(".newClients").hasClass("non-active")) {
                                    // console.log(stylistName);
                                    // console.log(stylistName[0]);
                                    $(".gokutest .desktopConfirmation .intial").empty().append(stylistName[0]);
                                    $(".gokutest .desktopConfirmation .name").empty().append(stylistName);
                                    $(".gokutest .desktopConfirmation .dateBlock div").empty().append(`${weekday[day]}, ${months[month]} ${date}, ${year} </br> ${time} - ${time2} EST`);
                                    $(".gokutest .desktopConfirmation .serviceBlock").append(`            <div>
              ${item.itemData.name} (${item.itemData.variations[0].itemVariationData.serviceDuration / 60000}mins) </br>
              <p>${item.itemData.variations[0].itemVariationData.priceMoney ? `$` + item.itemData.variations[0].itemVariationData.priceMoney.amount / 100 + `.00` : "Price Varies"}</p>
              </div>`);
                                    $(".gokutest .desktopConfirmation .loader2").addClass("non-active");
                                    // console.log(time)
                                    // console.log(time2)
                                }
                                if ($(".form123 .bookingForm").hasClass("active")) {
                                    $(".bookingDate").html(`${weekday[day]}, ${months[month]} ${date}, ${year} </br> ${time} - ${time2} EST`);
                                    $(".serviceBookingSide .loader2").addClass("non-active");
                                    $(".form123 .serviceEdit").on("click", function () {
                                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");

                                        $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                                        $(".staffMembers .addNames1").on("click", function () {
                                            duration = "";
                                            startTime = "";
                                            multiService = [];
                                            bookedStylist = "";
                                            //  $('.calendarMain .loader2').removeClass('non-active')
                                            $(".calendarTest .loader2").removeClass("non-active");
                                            $(".morning .slot").empty();
                                            $(".afternoon .slot").empty();
                                            $(".evening .slot").empty();

                                            if ($(".pleaseSelect").children.length > 0) {
                                                $(".pleaseSelect").empty();
                                            }

                                            let memberId = $(this).data("team-member-id");
                                            stylistName = $(this).data("team-member-name");
                                            stylist = memberId.split(",");
                                            $(".staffMembers .addNames1").removeClass("loaded");
                                            $(this).addClass("loaded");
                                            let date1 = new Date();
                                            let year = date1.getFullYear();
                                            let mon = date1.getMonth();
                                            let test5 = new Date(year, mon + 1, 0);
                                            test5.setUTCHours(23, 59, 59, 0);
                                            currMonth = new Date().getMonth();
                                            calendarChange();
                                            bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                                            serviceType1(serviceEnd, stylist);
                                            if ($(window).width() > 1023) {
                                                $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                                                $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                                                $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                                $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                                                $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                                                $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                                                $(".form123 .calendarTop .prev-arrow").on("click", prevMonth);
                                            }
                                        });
                                    });
                                    $(".form123 .timeEdit").on("click", function () {
                                        $(".calendarTest .loader2").removeClass("non-active");
                                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                                        $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                                        $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                        $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                                        $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                                        $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                                        $(".form123 .calendarTop .prev-arrow").on("click", prevMonth);
                                        let date1 = new Date();
                                        let year = date1.getFullYear();
                                        let mon = date1.getMonth();
                                        let test5 = new Date(year, mon + 1, 0);
                                        test5.setUTCHours(23, 59, 59, 0);
                                        currMonth = new Date().getMonth();
                                        calendarChange();
                                        bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                                        $(".serviceSideServices .loader2").addClass("non-active");
                                        $(".bookBut").on("click", function () {
                                            duration = $(this).data("duration");
                                            startTime = $(this).data("start-id");
                                            bookedStylist = $(this).data("team-member");
                                            $(".bookBut").removeClass("active3");
                                            $(this).addClass("active3");
                                            if ($(".pleaseSelect").children.length > 0) {
                                                $(".pleaseSelect").empty();
                                            }
                                            if ($(window).width() > 1023) {
                                                if ($(".oldClients").hasClass("non-active")) {
                                                    $(".form123").scrollTop(0);

                                                    serviceType1(serviceEnd, stylist, startTime);

                                                    $(".form123").empty().append($(".bookingForm").eq(0).clone().addClass("active"));
                                                    $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                                    ///mobile-version
                                                    $(".form123 #myForm1").on("submit", submitForm);
                                                } else {
                                                    serviceType1(serviceEnd, stylist, startTime);
                                                    $(".gokutest").empty().append($(".bookingForm").eq(0).clone().addClass("active"));
                                                    $(".gokutest .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                                    // $('.serviceBookingSide .loader2').addClass('non-active')
                                                    $(".gokutest #myForm1").on("submit", submitForm);
                                                }
                                            }
                                        });
                                    });
                                } else if ($(".form123 .serviceBooking").hasClass("active")) {
                                    $(".bookingName")
                                        .empty()
                                        .append(`${item.itemData.name} (${item.itemData.variations[0].itemVariationData.serviceDuration / 60000}mins)`);
                                    $(".bookingPrice")
                                        .empty()
                                        .append(`${item.itemData.variations[0].itemVariationData.priceMoney ? `$` + item.itemData.variations[0].itemVariationData.priceMoney.amount / 100 + `.00` : "Price Varies"}`);
                                    // $('.bookingTime').empty().append(`${duration} minutes`);
                                    $(".bookingStylist").empty().append(stylistName);
                                    $(".serviceBookingSide .loader2").addClass("non-active");

                                    $(".serviceEdit").on("click", function () {
                                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");

                                        $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                                        $(".staffMembers .addNames1").on("click", function () {
                                            duration = "";
                                            startTime = "";
                                            multiService = [];
                                            bookedStylist = "";
                                            //  $('.calendarMain .loader2').removeClass('non-active')
                                            $(".calendarTest .loader2").removeClass("non-active");
                                            $(".morning .slot").empty();
                                            $(".afternoon .slot").empty();
                                            $(".evening .slot").empty();

                                            if ($(".pleaseSelect").children.length > 0) {
                                                $(".pleaseSelect").empty();
                                            }

                                            let memberId = $(this).data("team-member-id");
                                            stylistName = $(this).data("team-member-name");
                                            stylist = memberId.split(",");
                                            $(".staffMembers .addNames1").removeClass("loaded");
                                            $(this).addClass("loaded");
                                            let date1 = new Date();
                                            let year = date1.getFullYear();
                                            let mon = date1.getMonth();
                                            let test5 = new Date(year, mon + 1, 0);
                                            test5.setUTCHours(23, 59, 59, 0);
                                            currMonth = new Date().getMonth();
                                            calendarChange();
                                            bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                                            serviceType1(serviceEnd, stylist);
                                            if ($(window).width() > 1023) {
                                                $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                                                $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                                                $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                                $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                                                $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                                                $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                                                $(".form123 .calendarTop .prev-arrow").on("click", prevMonth);
                                            }
                                        });
                                    });
                                } else if ($(".serviceList .bookingForm").hasClass("active")) {
                                    $(".bookingDate").html(`${weekday[day]}, ${months[month]} ${date}, ${year} </br> ${time} - ${time2} EST`);
                                    Array.from($(".gokutest .multiServiceItem .stylist")).forEach((item) => {
                                        $(item).empty().append(stylistName);
                                    });

                                    $(".serviceBookingSide .loader2").addClass("non-active");
                                }
                            }
                        }
                    });
                });
                if ($(window).width() < 1024) {
                    if ($(".oldClients").hasClass("non-active")) {
                    } else {
                        $(".form1234").empty().append($(".bookingConfirm").eq(0).clone().addClass("active"));
                    }
                }
            });
    }

    $(".mobileBottom1 .bots .bookingButton1.backButton").on("click", function () {
        if ($(".form123 .serviceBooking").hasClass("active")) {
            $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
            $(".serviceBooking").removeClass("active");
            $(".form123").empty();
            $(".mobileService3").addClass("active");
            $(".mobileBottom").addClass("active");
            $(".mobileBottom1").removeClass("active");
            $(".mobilePopup1").removeClass("mobileBookConfirm");
            // $('.calendarMain .loader2').removeClass('non-active');
            $(".calendarTest .loader2").removeClass("non-active");
            currMonth = new Date().getMonth();
            duration = "";
            startTime = "";
            multiService = [];
            bookedStylist = "";
        } else if ($(".form123 .bookingConfirm").hasClass("active")) {
            startTime = "";
            // $('.calendarMain .loader2').removeClass('non-active');
            $(".calendarTest .loader2").removeClass("non-active");

            $(".confirmButton").removeClass("active");
            $(".confirmButton").addClass("non-active");
            $(".nextButton").addClass("active");
            $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
            $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
            $(".form123").append($(".serviceBooking").eq(0).clone().addClass("active"));
            $(".form123 .calendarTop .next-arrow").removeClass("disabled");
            $(".form123 .calendarTop .prev-arrow").addClass("disabled");
            $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
            $(".form123 .calendarTop .prev-arrow").on("click", prevMonth);
            let date1 = new Date();
            let year = date1.getFullYear();
            let mon = date1.getMonth();
            let test5 = new Date(year, mon + 1, 0);
            test5.setUTCHours(23, 59, 59, 0);
            currMonth = new Date().getMonth();
            calendarChange();
            bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
            $(".form123 .staffMembers div:first").removeClass("loaded");
            $(".staffMembers .addNames1").on("click", addNames);
        } else if ($(".form123 .bookingForm").has("active")) {
            $(".bookNowButton").removeClass("active");
            $(".confirmButton").removeClass("non-active");
            $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
            $(".form123").empty().append($(".bookingConfirm").eq(0).clone().addClass("active"));
        }
    });

    $(".mobileBottom1 .bots .bookingButton.nextButton").on("click", function () {
        if ((serviceEnd, bookedStylist, startTime)) {
            $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
            $(".bookingLoadbar.four .bookingLoad:not(.loaded):first").addClass("loaded");
            $(".serviceBooking").removeClass("active");
            $(".staffBooking").removeClass("active");
            $(".mobilePopup1").addClass("mobileBookConfirm");
            serviceType1([serviceEnd], bookedStylist, startTime);
            // $('.form123').empty().append($('.bookingConfirm').eq(0).clone());
        } else {
            $(".pleaseSelect").html('<div style="text-align: center; color: red; padding-bottom: 10px;">Please select a timing</div>');
        }
    });
    $(".mobileBottom1 .bookingButton.confirmButton").on("click", function () {
        $(".form123").empty().append($(".bookingForm").eq(0).clone());
        $(".confirmButton").addClass("non-active");
        $(".bookNowButton").addClass("active");
        $(".mobilePopup1 .bookingConfirm").removeClass("active");
        $(".mobilePopup1 .bookingForm").addClass("active");
        // $('.mobileBottom1').removeClass('active')
        $(".form123 #myForm1").on("submit", function (e) {
            e.preventDefault();
            const serv = multiService[0];
            let x = [];
            const vidutest = serv.appointmentSegments.forEach((item) => {
                x.push({
                    teamMemberId: item.teamMemberId,
                    durationMinutes: item.durationMinutes,
                    serviceVariationId: item.serviceVariationId,
                    serviceVariationVersion: item.serviceVariationVersion,
                });
            });
            if ($("#myForm1 [name='firstName']").val().trim().length == 0) {
                document.querySelector("#myForm1 [name='firstName']").setCustomValidity("Please fill in your first name");
                document.querySelector("#myForm1 [name='firstName']").reportValidity();
            } else if ($("#myForm1 [name='lastName']").val().trim().length == 0) {
                document.querySelector("#myForm1 [name='lastName']").setCustomValidity("Please fill in your last name");
                document.querySelector("#myForm1 [name='lastName']").reportValidity();
            } else if (
                $("#myForm1 [name='email']").val().trim().length == 0 ||
                $("#myForm1 [name='email']")
                    .val()
                    .match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g) == null
            ) {
                document.querySelector("#myForm1 [name='email']").setCustomValidity("Please fill in correct email format, i.e example@example.com");
                document.querySelector("#myForm1 [name='email']").reportValidity();
            } else if (
                $("#myForm1 [name='number']").val().trim().length == 0 ||
                $("#myForm1 [name='number']")
                    .val()
                    .match(/^[+]*[1]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g) == null
            ) {
                document.querySelector("#myForm1 [name='number']").setCustomValidity("Please fill in correct phone number format, i.e 0123456789");
                document.querySelector("#myForm1 [name='number']").reportValidity();
            } else {
                $(".bookNowButton").addClass("loading");
                $("#myForm1 input").prop("disabled", true);
                $("#myForm1 select").prop("disabled", true);
                $("#myForm1 textarea").prop("disabled", true);
                $("#myForm1 button").prop("disabled", true);
                fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
                    method: "POST",
                    headers: {
                        accept: "application/json",
                        "content-type": "application/json",
                    },
                    body: JSON.stringify({
                        email: $("#myForm1 input[name=email]").val(),
                    }),
                })
                    .then((r) => r.json())
                    .then((r) => {
                        if (jQuery.isEmptyObject(r)) {
                            createCustomer(x, "#myForm1");
                        } else {
                            $(".accExistsOverlay").removeClass("non-active");
                            // createBooking(r.customers[0].id, x, "#myForm1")
                            $(".accExistsOverlay .bookingButton").on("click", function () {
                                console.log("hi");
                                currMonth = new Date().getMonth();
                                $(".serviceList .bookNowButton").removeClass("active");
                                $(".serviceList .botss .nextButton").addClass("active");
                                $(".newClients").addClass("non-active");
                                $(".oldClients").removeClass("non-active");
                                $(".mobilePopup").css("max-height", "0px");
                                $(".accExistsOverlay").addClass("non-active");
                                if (localStorage.getItem("email")) {
                                    $(".oldClients").empty().append($(".oldClientsLogin").eq(0).clone().addClass("active"));
                                    $(".oldClientsLogin .signIn_square .block").addClass("non-active");
                                    $(".oldClientsLogin .myAppts").addClass("active");
                                    $(".oldClientsLogin .myAppts .newName").empty().append(localStorage.getItem("name"));
                                    $(".oldClientsLogin .myAppts button").on("click", { email: localStorage.getItem("email") }, clientInfo);

                                    $(".oldClients .myAppts div").on("click", function () {
                                        localStorage.removeItem("email");
                                        localStorage.removeItem("name");
                                        localStorage.removeItem("lastName");

                                        $(".oldClientsLogin .signIn_square .block").removeClass("non-active");
                                        $(".oldClientsLogin .myAppts").removeClass("active");
                                        $(".oldClientsLogin .signIn_square .sqLogin").on("click", function () {
                                            $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                                            $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                                            $(".squareupLogin #loginForm input").prop("disabled", false);
                                            $(".requestButton").removeClass("loading");

                                            $(".squareuplogin #loginForm").on("submit", checkCustomer);
                                        });
                                    });
                                }
                            });
                        }
                    });
            }
        });

        if ($(".oldClients").hasClass("non-active")) {
            $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
            $(".serviceList .mobileBottom1").removeClass("active");
        }
    });

    function submitForm(e) {
        e.preventDefault();
        const serv = multiService[0];
        let x = [];
        const vidutest = serv.appointmentSegments.forEach((item) => {
            x.push({
                teamMemberId: item.teamMemberId,
                durationMinutes: item.durationMinutes,
                serviceVariationId: item.serviceVariationId,
                serviceVariationVersion: item.serviceVariationVersion,
            });
        });
        if ($("#myForm1 [name='firstName']").val().trim().length == 0) {
            document.querySelector("#myForm1 [name='firstName']").setCustomValidity("Please fill in your first name");
            document.querySelector("#myForm1 [name='firstName']").reportValidity();
        } else if ($("#myForm1 [name='lastName']").val().trim().length == 0) {
            document.querySelector("#myForm1 [name='lastName']").setCustomValidity("Please fill in your last name");
            document.querySelector("#myForm1 [name='lastName']").reportValidity();
        } else if (
            $("#myForm1 [name='email']").val().trim().length == 0 ||
            $("#myForm1 [name='email']")
                .val()
                .match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g) == null
        ) {
            document.querySelector("#myForm1 [name='email']").setCustomValidity("Please fill in correct email format, i.e example@example.com");
            document.querySelector("#myForm1 [name='email']").reportValidity();
        } else if (
            $("#myForm1 [name='number']").val().trim().length == 0 ||
            $("#myForm1 [name='number']")
                .val()
                .match(/^[+]*[1]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g) == null
        ) {
            document.querySelector("#myForm1 [name='number']").setCustomValidity("Please fill in correct phone number format, i.e 0123456789");
            document.querySelector("#myForm1 [name='number']").reportValidity();
        } else {
            $(".bookNowButton").addClass("loading");
            $(".hidden").addClass("non-active");
            $(".afterBooking").addClass("loading");

            $("#myForm1 input").prop("disabled", true);
            $("#myForm1 select").prop("disabled", true);
            $("#myForm1 textarea").prop("disabled", true);
            $("#myForm1 button").prop("disabled", true);
            fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
                method: "POST",
                headers: {
                    accept: "application/json",
                    "content-type": "application/json",
                },
                body: JSON.stringify({
                    email: $("#myForm1 input[name=email]").val(),
                }),
            })
                .then((r) => r.json())
                .then((r) => {
                    if (jQuery.isEmptyObject(r)) {
                        createCustomer(x, "#myForm1");
                    } else {
                        // createBooking(r.customers[0].id, x, "#myForm1")
                        $(".accExistsOverlay").removeClass("non-active");
                        // createBooking(r.customers[0].id, x, "#myForm1")
                        $(".accExistsOverlay .bookingButton").on("click", function () {
                            $(".newClients").addClass("non-active");
                            $(".oldClients").removeClass("non-active");
                            $(".mobilePopup").css("max-height", "0px");
                            $(".accExistsOverlay").addClass("non-active");
                            if ($(window).width() > 1023) {
                                if (localStorage.getItem("email")) {
                                    let setheight = $(".page").height();
                                    console.log(setheight);
                                    $(".serviceList").css("max-height", `${setheight}px`);
                                    showService();
                                    $(".loggedInDesktop .para").on("click", { email: localStorage.getItem("email") }, clientInfo);
                                    $(".loggedInDesktop .para1").on("click", function () {
                                        console.log("Sign out");
                                        localStorage.removeItem("email");
                                        localStorage.removeItem("name");
                                        localStorage.removeItem("lastName");
                                        $(".oldClients").removeClass("active");
                                        $(".oldClients").addClass("non-active");
                                        $(".newClients").removeClass("non-active");
                                        $(".serviceList").css("max-height", "0px");
                                    });
                                    $(".newClients").addClass("non-active");
                                    $(".oldClients").addClass("active");
                                    // $('.oldClients .clientProfile')
                                } else {
                                    $(".oldClients").removeClass("non-active");
                                    $(".newClients").addClass("non-active");
                                    $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                                    $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                                    $(".squareupLogin #loginForm input").prop("disabled", false);
                                    $(".requestButton").removeClass("loading");

                                    $(".squareuplogin #loginForm").on("submit", checkCustomer);
                                }
                            }
                        });
                    }
                });
        }
    }
    function showCodeMessage(code, email, firstName, customerId, lastName) {
        $(".oldClients .loginForm").empty().append($(".oldClientsCode").eq(0).clone().addClass("active"));
        $(".oldClientsCode.active .cancel").on("click", function () {
            $(".oldClients").addClass("non-active");
            $(".newClients").removeClass("non-active");
        });
        $(".oldClientsCode.active .resend").on("click", function () {
            fetch(`https://shp-webserver-temp.glitch.me/squareup-log`, {
                method: "POST",
                headers: {
                    accept: "application/json",
                    "content-type": "application/json",
                },
                body: JSON.stringify({
                    email: email,
                }),
            })
                .then((r) => r.json())
                .then((r) => {
                    let code = r.check;
                    showCodeMessage(code, email, firstName, customerId, lastName);
                });
        });
        $(".oldClientsCode #codeLogin").on("submit", function (e) {
            e.preventDefault();
            $(".oldClientsCode .incorrectCode").html(``);

            $(".oldClientsCode .requestButton").addClass("loading");

            if ($(".oldClients #codeLogin [name=code]").val() == code) {
                if (localStorage.getItem("savedBooking")) {
                    console.log("saved");
                    const serv = multiService[0];
                    let x = [];
                    serv.appointmentSegments.forEach((item) => {
                        x.push({
                            teamMemberId: item.teamMemberId,
                            durationMinutes: item.durationMinutes,
                            serviceVariationId: item.serviceVariationId,
                            serviceVariationVersion: item.serviceVariationVersion,
                        });
                    });
                    let setheight = $(".page").height();
                    $(".serviceList").css("max-height", `${setheight}px`);
                    $(".serviceList .form1234").empty().append($(".bookingConfirm").eq(0).clone().addClass("active"));
                    $(".serviceList .form1234 .loader2").addClass("non-active");
                    $(".serviceList .mobileBottom1 .botss .confirmButton").addClass("active");
                    $(".serviceList .mobileBottom1 .botss .bookNowButton").removeClass("active");
                    localStorage.setItem("email", email);
                    localStorage.setItem("name", firstName);
                    localStorage.setItem("lastName", lastName);
                    localStorage.setItem("customerId", customerId);
                    /////////
                    ///////////AFTER LOGIN SUCCESSFUL, PULL UP BOOKING CONFIRMATION PAGE
                    ////////
                } else {
                    if ($(window).width() > 1023) {
                        setTimeout(function () {
                            localStorage.setItem("email", email);
                            localStorage.setItem("name", firstName);
                            localStorage.setItem("lastName", lastName);
                            localStorage.setItem("customerId", customerId);
                            showService();
                            // $('.loggedInDesktop .para').on('click', {email:email}, clientInfo);
                            $(".loggedInDesktop .para").on("click", { email: email }, clientInfo);
                            $(".loggedInDesktop .para1").on("click", function () {
                                console.log("Sign out");
                                localStorage.removeItem("email");
                                localStorage.removeItem("name");
                                localStorage.removeItem("lastName");
                                $(".oldClients").removeClass("active");
                                $(".oldClients").addClass("non-active");
                                $(".newClients").removeClass("non-active");
                                $(".serviceList").css("max-height", "0px");
                            });
                        }, 1500);
                    } else {
                        setTimeout(function () {
                            $(".oldClients").empty().append($(".oldClientsLogin").eq(0).clone().addClass("active"));
                            $(".oldClientsLogin .signIn_square .block").addClass("non-active");
                            $(".oldClientsLogin .myAppts").addClass("active");
                            $(".oldClientsLogin .myAppts button").on("click", { email: email }, clientInfo);
                            $(".oldClientsLogin .myAppts .newName").empty().append(`${firstName}`);
                            $(".oldClients .myAppts div").on("click", function () {
                                localStorage.removeItem("email");
                                localStorage.removeItem("name");
                                localStorage.removeItem("lastName");

                                $(".oldClientsLogin .signIn_square .block").removeClass("non-active");
                                $(".oldClientsLogin .myAppts").removeClass("active");
                                $(".oldClientsLogin .signIn_square .sqLogin").on("click", function () {
                                    $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                                    $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                                    $(".squareupLogin #loginForm input").prop("disabled", false);
                                    $(".requestButton").removeClass("loading");

                                    $(".squareuplogin #loginForm").on("submit", checkCustomer);
                                });
                            });
                            $(".oldClients .button2").on("click", showService);

                            localStorage.setItem("email", email);
                            localStorage.setItem("name", firstName);
                            localStorage.setItem("lastName", lastName);
                            localStorage.setItem("customerId", customerId);
                        }, 2000);
                    }
                }
            } else {
                $(".oldClientsCode .requestButton").removeClass("loading");
                $(".oldClientsCode .incorrectCode").html(`The code you entered is incorrect.`);
            }
        });
    }

    function clientInfo(e) {
        let email = e.data.email;
        $(".oldClientsLogin .myAppts .loadButton").addClass("loading");
        fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                email: email,
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                let results = r.customers[0];
                $(".oldClients").empty().append($(".clientProfile").eq(0).clone().addClass("active"));
                $(".clientProfile .topBlock .initial").empty().append(`${results.givenName[0]}${results.familyName[0]}`);
                $(".clientProfile .topBlock .name").empty().append(`${results.givenName} ${results.familyName}`);
                // console.log(results);
                $(".oldClientsLogin .myAppts .loadButton").removeClass("loading");

                getAppointments(results.id, email);
                if ($(window).width() > 1023) {
                    $(".serviceList").css("max-height", "0px");
                }
            });
    }
    function getAppointments(id, email) {
        fetch(`https://shp-webserver-temp.glitch.me/customerCustomAttributes`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                id: id,
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                retrieveBookings(r.customAttributes[0].value, email);
            });
    }
    function serviceName(id) {
        return fetch(`https://shp-webserver-temp.glitch.me/sq-servicetype`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
        })
            .then((r) => r.json())
            .then((data) => {
                // console.log(r.items)
                // console.log(data.items)
                // const vidu = r.items.filter((item) => item.itemData.variations[0].id == id)
                // let name = vidu[0].itemData.name
                return data;
            });
    }
    async function retrieveBookings(id, email) {
        // console.log(id.split(','))
        // console.log(id)
        // console.log(email)
        if (id) {
            $(".appointmentList .upcomingList .apptBlock").remove();
            $(".appointmentList .pastList .apptBlock").remove();

            await Promise.all(
                id.split(",").map(async (item) => {
                    setTimeout(function () {
                        fetch(`https://shp-webserver-temp.glitch.me/retrieveBooking`, {
                            method: "POST",
                            headers: {
                                accept: "application/json",
                                "content-type": "application/json",
                            },
                            body: JSON.stringify({
                                id: item,
                            }),
                        })
                            .then((r) => r.json())
                            .then((r) => {
                                let timeStart = r.booking.startAt;
                                // console.log(r)
                                let currentTime = new Date();
                                let durationMins = new Date(timeStart);
                                let day = new Date(timeStart).getDay();
                                let date = new Date(timeStart).getDate();
                                let month = new Date(timeStart).getMonth();
                                let year = new Date(timeStart).getFullYear();
                                let time = new Date(timeStart).toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
                                // let timeStart2 = durationMins.getMinutes()
                                // let timeStart2 = durationMins.setMinutes(durationMins.getMinutes());
                                // let timeStart2 = durationMins.getMinutes()
                                // let time2 = new Date(timeStart2).toLocaleTimeString('en-US', {hour:"numeric", minute: "2-digit"});
                                // console.log(time2)
                                serviceName()
                                    .then((item1) => {
                                        // console.log(r)''

                                        $(`.appointmentList ${durationMins > currentTime ? `.upcomingList` : `.pastList`}`).append(`
          <div id='${r.booking.id}' class='apptBlock'>
            
            ${durationMins > currentTime ? "" : `<span>View Details</span>`}
            <div class='sellerinfo'>

              <div class='sellerFirst'></div>

              <div style='text-align:start;'>
                <div style='color:#b3b3b3; font-size:13px;'>Confirmed With</div>
                <div style='font-weight:600; font-size:16px;' class='stylistName'></div>
              </div>

            </div>

            <div class='dateTime details'>
              <img style='width:25px; height:25px;' src='/content/images/marketing/gta-booking/clock.png'>
              <div class='timeFrame'></div>
            </div>
            <div class='details'>
              <img style='width:25px; height:25px;' src='/content/images/marketing/gta-booking/price-tag.png'>
              <div class='serviceDetails'></div>
            </div>
          </div>
          `);

                                        r.booking.appointmentSegments.map((item) => {
                                            const vidu = currentStylers.filter((item3) => item3.team_member_id == item.teamMemberId);
                                            const vidu1 = item1.items.filter((item2) => item2.itemData.variations[0].id == item.serviceVariationId);
                                            $(`#${r.booking.id}.apptBlock .sellerFirst`).empty().append(vidu[0].display_name[0]);
                                            // const vidu1 = currentStylers.filter((item3) => item3.team_member_id == item.teamMemberId);
                                            let timeStart2 = durationMins.setMinutes(durationMins.getMinutes() + item.durationMinutes);
                                            let time2 = new Date(timeStart2).toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });

                                            $(`#${r.booking.id}.apptBlock .dateTime .timeFrame`).empty().append(`${weekday[day]}, ${months[month]} ${date}, ${year} </br> ${time} - ${time2} EST`);
                                            $(`#${r.booking.id}.apptBlock .stylistName`).empty().append(vidu[0].display_name);
                                            $(`#${r.booking.id}.apptBlock .serviceDetails`).append(`
    <div>
      ${vidu1[0].itemData.name} (${vidu1[0].itemData.variations[0].itemVariationData.serviceDuration / 60000}mins) ${
                                                vidu1[0].itemData.variations[0].itemVariationData.priceMoney ? `$` + vidu1[0].itemData.variations[0].itemVariationData.priceMoney.amount / 100 + `.00` : "Price Varies"
                                            }
    </div>
    `);
                                        });
                                    })
                                    .then(() => {
                                        $(".oldClients .pastList .apptBlock span").on("click", function () {
                                            console.log($(this).siblings().find(".sellerFirst")[0].innerHTML);
                                            let initial = $(this).siblings().find(".sellerFirst")[0].innerHTML;
                                            let name = $(this).siblings().find(".stylistName")[0].innerHTML;
                                            let date = $(this).siblings().find(".timeFrame")[0].innerHTML;
                                            let detail = $(this).siblings().find(".serviceDetails")[0].innerHTML;
                                            $(".apptDetails").removeClass("non-active");
                                            $(".apptDetails .initial").html(initial);
                                            console.log("sioker");
                                            $(".apptDetails .name").html(name);
                                            $(".apptDetails .date").html(date);
                                            $(".apptDetails .service").html(detail);
                                            $(".apptDetails .detailsTopBlock").empty().append($(".apptPast").eq(0).clone().removeClass("non-active"));
                                            let setheight = $(".page").height();
                                            $(".apptDetails").css("max-height", `${setheight}px`);

                                            $(".apptDetails .back").on("click", function () {
                                                $(".apptDetails").css("max-height", `0px`);
                                            });
                                        });
                                    })
                                    .then(() => {
                                        let x = $(".oldClients .clientProfile .bottomBlock .upcomingList").children().length;
                                        let y = $(".oldClients .clientProfile .bottomBlock .pastList").children().length;
                                        // console.log(x);
                                        // console.log(y);
                                        if (x == 1) {
                                            $(".oldClients .upcomingList .loader2").addClass("non-active");
                                            $(".oldClients .upcomingList").append(`<div class='noUpcoming' style='padding-top:20px; font-weight:500;'>You have no upcoming appointments</div>`);
                                        } else {
                                            $(".oldClients .upcomingList .loader2").addClass("non-active");
                                            $(".oldClients .upcomingList .noUpcoming").addClass("non-active");
                                        }
                                        if (y == 1) {
                                            $(".oldClients .pastList .loader2").addClass("non-active");
                                            $(".oldClients .pastList").append(`<div class='noPast' style='padding-top:20px; font-weight: 500;'>You have no past appointments</div>`);
                                        } else {
                                            $(".oldClients .upcomingList .noPast").addClass("non-active");
                                            $(".oldClients .pastList .loader2").addClass("non-active");
                                        }
                                    });
                            });
                    }, 500);
                })
            );
            let x = $(".oldClients .clientProfile .bottomBlock .upcomingList").children().length;
        } else {
            $(".oldClients .upcomingList .loader2").addClass("non-active");
            $(".oldClients .pastList .loader2").addClass("non-active");
            $(".oldClients .upcomingList").append(`<div class='noUpcoming' style='padding-top:20px; font-weight:500;'>You have no upcoming appointments</div>`);
            $(".oldClients .pastList").append(`<div class='noPast' style='padding-top:20px; font-weight: 500;'>You have no past appointments</div>`);
        }

        // let x = $('.oldClients .clientProfile .bottomBlock .upcomingList').children().length;
        //       let y = $('.oldClients .clientProfile .bottomBlock .pastList').children().length;
        //       // console.log(x);
        //       // console.log(y);
        //       // console.log($('.oldClients .clientProfile .upcomingList'))
        //       if (x == 1) {
        //         $('.oldClients .upcomingList .loader2').addClass('non-active');
        //         $('.oldClients .upcomingList').append(`<div class='noUpcoming' style='padding-top:20px; font-weight:500;'>You have no upcoming appointments</div>`);
        //       } else {

        //         $('.oldClients .upcomingList .loader2').addClass('non-active');
        //         $('.oldClients .upcomingList .noUpcoming').addClass('non-active');
        //       }
        //       if (y == 1) {
        //         $('.oldClients .pastList .loader2').addClass('non-active');
        //         $('.oldClients .pastList').append(`<div class='noPast' style='padding-top:20px; font-weight: 500;'>You have no past appointments</div>`);
        //       } else {
        //         $('.oldClients .upcomingList .noPast').addClass('non-active');
        //         $('.oldClients .pastList .loader2').addClass('non-active');

        //       };

        $(".oldClients .apptList .past").on("click", function () {
            $(".oldClients .apptList .upcoming").removeClass("active");
            $(".oldClients .apptList .past").addClass("active");
            $(".oldClients .appointmentList .upcomingList").addClass("non-active");
            $(".oldClients .appointmentList .pastList").removeClass("non-active");
        });
        $(".oldClients .apptList .upcoming").on("click", function () {
            $(".oldClients .apptList .upcoming").addClass("active");
            $(".oldClients .apptList .past").removeClass("active");
            $(".oldClients .appointmentList .upcomingList").removeClass("non-active");
            $(".oldClients .appointmentList .pastList").addClass("non-active");
        });
        $(".oldClients .clientProfile .topBlock .info").on("click", function () {
            $(".oldClients .clientProfile .bottomBlock").removeClass("non-active");
            $(".oldClients .clientProfile .profileBlock").addClass("non-active");
        });
        $(".oldClients .clientProfile .midBlock .bookingButton").on("click", showService);
        $(".multiServiceSide .multiServiceItem").remove();
        $(".oldClients .clientProfile .signOutBlock div").on("click", function () {
            // console.log('hi')
            localStorage.removeItem("email");
            localStorage.removeItem("name");
            localStorage.removeItem("lastName");
            if ($(window).width() > 1023) {
                $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                $(".squareupLogin #loginForm input").prop("disabled", false);
                $(".requestButton").removeClass("loading");
                $(".squareuplogin #loginForm").on("submit", checkCustomer);
            } else {
                $(".oldClients").empty().append($(".oldClientsLogin").eq(0).clone().addClass("active"));

                $(".oldClientsLogin .signIn_square .block").removeClass("non-active");
                $(".oldClientsLogin .myAppts").removeClass("active");
                $(".oldClientsLogin .signIn_square .sqLogin").on("click", function () {
                    $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                    $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                    $(".squareupLogin #loginForm input").prop("disabled", false);
                    $(".requestButton").removeClass("loading");

                    $(".squareuplogin #loginForm").on("submit", checkCustomer);
                });
            }
        });

        if (!$._data($(".oldClients .viewProfile").get(0), "events")) {
            $(".clientProfile .viewProfile").on("click", function () {
                fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
                    method: "POST",
                    headers: {
                        accept: "application/json",
                        "content-type": "application/json",
                    },
                    body: JSON.stringify({
                        email: email,
                    }),
                })
                    .then((r) => r.json())
                    .then((r) => {
                        let cust = r.customers[0];
                        $(".profileBlock .name").empty().append(`${cust.givenName} ${cust.familyName}`);
                        $(".profileBlock .email").empty().append(`${cust.emailAddress}`);
                        $(".profileBlock .phoneNumber").empty().append(`${cust.phoneNumber} `);
                        $(".oldClients .clientProfile .bottomBlock").addClass("non-active");
                        $(".oldClients .clientProfile .profileBlock").removeClass("non-active");
                        // <div class="profileBlock non-active">
                        //   <p>My profile</p>
                        //   <div>Please contact Superhairpieces.ca to update your contact information</div>
                        //   <div>
                        //     <p class="name">Name</p>
                        //     <p class="email">Email</p>
                        //     <p class="phoneNumber">Phone Number</p>
                    });
                // $('.profileBlock .name')
                // $('.oldClients .clientProfile .bottomBlock').addClass('non-active')
                // $('.oldClients .clientProfile .profileBlock').removeClass('non-active')
            });
        }

        // console.log(promises)
    }

    function checkCustomer(e) {
        e.preventDefault();
        $(".squareupLogin #loginForm .accountExistence").html(``);
        $(".squareupLogin #loginForm input").prop("disabled", true);
        $(".squareuplogin .requestButton").addClass("loading");

        let email = $(".oldClients .squareupLogin [name=email]").val();
        fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                email: email,
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                if (jQuery.isEmptyObject(r)) {
                    $(".squareupLogin #loginForm .accountExistence").html(`Account does not exist. Please sign up!`);
                    $(".squareuplogin .requestButton").removeClass("loading");
                    $(".squareupLogin #loginForm input").prop("disabled", false);

                    // createCustomer(x, "#myForm")
                } else {
                    loginToSquareAcc(r.customers[0].givenName, r.customers[0].familyName, r.customers[0].id);

                    // createBooking(r.customers[0].id, x, "#myForm")
                }
            });
    }

    function loginToSquareAcc(firstName, lastName, customerId) {
        if (
            $("#loginForm [name='email']").val().trim().length == 0 ||
            $("#loginForm [name='email']")
                .val()
                .match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g) == null
        ) {
            document.querySelector("#loginForm [name='email']").setCustomValidity("Please fill in correct email format, i.e example@example.com");
            document.querySelector("#loginForm [name='email']").reportValidity();
        } else {
            let email = $("#loginForm [name='email']").val();

            fetch(`https://shp-webserver-temp.glitch.me/squareup-log`, {
                method: "POST",
                headers: {
                    accept: "application/json",
                    "content-type": "application/json",
                },
                body: JSON.stringify({
                    email: $("#loginForm [name='email']").val(),
                }),
            })
                .then((r) => r.json())
                .then((r) => {
                    let code = r.check;
                    // console.log(r)
                    // checkCustomer($("#loginForm [name='email']").val(), code)
                    //TESTING
                    // showCodeMessage(r, email, firstName, customerId, lastName);
                    //REAl
                    showCodeMessage(code, email, firstName, customerId, lastName);
                });
        }
    }

    $("#myForm1").on("submit", function (e) {
        e.preventDefault();
        const serv = multiService[0];
        let x = [];
        const vidutest = serv.appointmentSegments.forEach((item) => {
            x.push({
                teamMemberId: item.teamMemberId,
                durationMinutes: item.durationMinutes,
                serviceVariationId: item.serviceVariationId,
                serviceVariationVersion: item.serviceVariationVersion,
            });
        });
        if ($("#myForm1 [name='firstName']").val().trim().length == 0) {
            document.querySelector("#myForm1 [name='firstName']").setCustomValidity("Please fill in your first name");
            document.querySelector("#myForm1 [name='firstName']").reportValidity();
        } else if ($("#myForm1 [name='lastName']").val().trim().length == 0) {
            document.querySelector("#myForm1 [name='lastName']").setCustomValidity("Please fill in your last name");
            document.querySelector("#myForm1 [name='lastName']").reportValidity();
        } else if (
            $("#myForm1 [name='email']").val().trim().length == 0 ||
            $("#myForm1 [name='email']")
                .val()
                .match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/g) == null
        ) {
            document.querySelector("#myForm1 [name='email']").setCustomValidity("Please fill in correct email format, i.e example@example.com");
            document.querySelector("#myForm1 [name='email']").reportValidity();
        } else if (
            $("#myForm1 [name='number']").val().trim().length == 0 ||
            $("#myForm1 [name='number']")
                .val()
                .match(/^[+]*[1]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g) == null
        ) {
            document.querySelector("#myForm1 [name='number']").setCustomValidity("Please fill in correct phone number format, i.e 0123456789");
            document.querySelector("#myForm1 [name='number']").reportValidity();
        } else {
            $(".mobilePopup .bookNowButton").addClass("loading");
            fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
                method: "POST",
                headers: {
                    accept: "application/json",
                    "content-type": "application/json",
                },
                body: JSON.stringify({
                    email: $("#myForm1 input[name=email]").val(),
                }),
            })
                .then((r) => r.json())
                .then((r) => {
                    if (jQuery.isEmptyObject(r)) {
                        createCustomer(x, "#myForm1");
                    } else {
                        createBooking(r.customers[0].id, x, "#myForm1");
                    }
                });
        }

        // $("button").prop("disabled", "disabled");
        // $(".e-submit .e-content input").prop("readonly", true);
        // $("button[type=submit]").html(`<img src="/content/images/common/loading.svg" width="20px" height="20px"/>`)
    });

    $("#myForm").on("submit", function (e) {
        e.preventDefault();
        const serv = multiService[0];
        let x = [];
        serv.appointmentSegments.forEach((item) => {
            x.push({
                teamMemberId: item.teamMemberId,
                durationMinutes: item.durationMinutes,
                serviceVariationId: item.serviceVariationId,
                serviceVariationVersion: item.serviceVariationVersion,
            });
        });
        $(".bookNowButton").addClass("loading");
        if ($(".newClients").hasClass("non-active")) {
            $(".serviceList .bookNowButton").addClass("loading");
        } else {
            $(".mobilePopup .bookNowButton").addClass("loading");
        }
        // $("button").prop("disabled", "disabled");
        // $(".e-submit .e-content input").prop("readonly", true);
        // $("button[type=submit]").html(`<img src="/content/images/common/loading.svg" width="20px" height="20px"/>`)

        fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                email: $("#myForm input[name=email]").val(),
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                if (jQuery.isEmptyObject(r)) {
                    createCustomer(x, "#myForm");
                } else {
                    // createBooking(r.customers[0].id, x, "#myForm")
                }
            });
    });
    function createCustomer1(e) {
        $(".squareupSignUpForm .accExists").removeClass("active");
        let form = e.data.id;
        e.preventDefault();
        $(".squareupSignupForm #signupForm .bookingButton").addClass("loading");
        fetch(`https://shp-webserver-temp.glitch.me/squareup-checkCustomer`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                email: $(`${form} input[name=email]`).val(),
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                if (jQuery.isEmptyObject(r)) {
                    fetch(`https://shp-webserver-temp.glitch.me/squareup-createCustomer`, {
                        method: "POST",
                        headers: {
                            accept: "application/json",
                            "content-type": "application/json",
                        },
                        body: JSON.stringify({
                            firstName: $(`${form} input[name=firstName]`).val(),
                            lastName: $(`${form} input[name=lastName]`).val(),
                            email: $(`${form} input[name=email]`).val(),
                            phone: $(`${form} input[name=number]`).val(),
                        }),
                    })
                        .then((r) => r.json())
                        .then((r) => {
                            let results = r.customer;
                            setTimeout(function () {
                                $(".oldClients").empty().append($(".clientProfile").eq(0).clone().addClass("active"));
                                $(".clientProfile .topBlock .initial").append(`${results.givenName[0]}${results.familyName[0]}`);
                                $(".clientProfile .topBlock .name").append(`${results.givenName} ${results.familyName}`);
                                getAppointments(results.id, results.emailAddress);
                                localStorage.setItem("email", results.emailAddress);
                                localStorage.setItem("name", results.givenName);
                                localStorage.setItem("lastName", results.familyName);
                                localStorage.setItem("customerId", results.id);
                            }, 1500);
                        });
                } else {
                    $(".squareupSignupForm .loadButton").removeClass("loading");
                    $(".squareupSignupForm .accExists").addClass("active").empty().append("Account already exists");
                }
            });
    }
    function createCustomer(x, form) {
        fetch(`https://shp-webserver-temp.glitch.me/squareup-createCustomer`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                firstName: $(`${form} input[name=firstName]`).val(),
                lastName: $(`${form} input[name=lastName]`).val(),
                email: $(`${form} input[name=email]`).val(),
                phone: $(`${form} input[name=number]`).val(),
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                // console.log(r)
                setTimeout(() => {
                    createBooking(r.customer.id, x, form, r.customer);
                }, 1000);
            });
    }

    function createBooking(id, serv, form, customerInfo) {
        // console.log(id)
        // console.log(serv)
        // console.log(form)
        // console.log(customerInfo)
        let notes = "";
        if (localStorage.getItem("email")) {
            notes = $(`${form} div[name=apptNotes]`).html();
        } else {
            notes = $(`.bookingForm.active ${form} textarea[name=appNotes]`).val();
        }
        fetch(`https://shp-webserver-temp.glitch.me/squareup-createBooking`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
            body: JSON.stringify({
                startAt: multiService[0].startAt,
                locationId: multiService[0].locationId,
                customerId: id,
                customerNote: notes || "N/A",
                book: serv,
            }),
        })
            .then((r) => r.json())
            .then((r) => {
                let results = customerInfo;
                console.log("created booking");
                if ($(".newClients").hasClass("non-active")) {
                    setTimeout(function () {
                        $(".loader2").removeClass("non-active");
                        // $('.serviceList').css('max-height', '0px');
                        // localStorage.setItem('email', results.emailAddress);
                        // localStorage.setItem('name', results.givenName);
                        // localStorage.setItem('lastName', results.familyName);
                        // localStorage.setItem('customerId', results.id);
                        if ($(".oldClients .clientProfile").hasClass("active")) {
                            // $('.appointmentList .upcomingList').empty();
                            // $('.appointmentList .pastList').empty();
                            getAppointments(results, localStorage.getItem("email"));
                            $(".serviceList").css("max-height", "0px");
                        } else {
                            let first = localStorage.getItem("name");
                            let last = localStorage.getItem("lastName");

                            $(".oldClients").empty().append($(".clientProfile").eq(0).clone().addClass("active"));
                            $(".clientProfile .topBlock .initial").append(`${first[0]}${last[0]}`);
                            $(".clientProfile .topBlock .name").append(`${first} ${last}`);
                            // getAppointments(results.id, localStorage.getItem('email'));
                            setTimeout(() => {
                                getAppointments(results, localStorage.getItem("email"));
                            }, 1000);

                            $(".serviceList").css("max-height", "0px");
                            $(".upcomingList .loader2").addClass("non-active");
                        }
                    }, 1500);
                    $(".serviceList .botss").empty();
                    $(".serviceList .botss").append(`
        <div style='text-align:center;' class='bookingButton'>Booked</div>
        `);
                } else {
                    setTimeout(function () {
                        $(".loader2").removeClass("non-active");

                        $(".oldClients").empty().append($(".clientProfile").eq(0).clone().addClass("active"));
                        $(".clientProfile .topBlock .initial").append(`${results.givenName[0]}${results.familyName[0]}`);
                        $(".clientProfile .topBlock .name").append(`${results.givenName} ${results.familyName}`);
                        getAppointments(results.id, results.emailAddress);
                        localStorage.setItem("email", results.emailAddress);
                        localStorage.setItem("name", results.givenName);
                        localStorage.setItem("lastName", results.familyName);

                        localStorage.setItem("customerId", results.id);
                        $(".mobilePopup").css("max-height", "0px");
                        $(".newClients").addClass("non-active");
                        $(".oldClients").removeClass("non-active");
                    }, 1500);
                    $(".mobilePopup .bots").empty();
                    $(".mobilePopup .bots").append(`
        <div style='text-align:center;' class='bookingButton'>Booked</div>
        `);
                }
                if ($(window).width() > 1023) {
                    $(".submitFormButtons").empty();
                    $(".submitFormButtons").append(`<div style='text-align:center;' class='afterBooking'>Booked</div>`);
                }
            });
    }
    function showService(e) {
        serviceEnd1 = [];
        serviceEnd = [];
        stylistName = "";
        currMonth = new Date().getMonth();
        $(".gokutest .top-list").css("display", "");
        $(".gokutest .loggedInDesktop").css("display", "");
        $(".gokutest .multiServiceDesk").css("display", "");
        $(".gokutest .multiServiceDesk1 .list-service-title").removeClass("non-active");
        $(".gokutest .multiServiceDesk1 .list-mens").removeClass("non-active");
        $(".gokutest .multiServiceDesk1 .serviceBooking").removeClass("active");
        $(".gokutest .multiServiceItem").remove();
        $(".gokutest .desktopConfirmation").removeClass("active");
        $(".list-item").unbind("click");

        let serviceType, serviceCate;
        if (e) {
            serviceType = e.target.getAttribute("data-service");
            serviceCate = e.target.getAttribute("data-service-cate");
        } else {
            serviceType = "Men";
            serviceCate = "KYEHUUDWR5NEVDVGK2NOS2G4";
        }
        // $('.oldClients .button2').on('click', (e) => {
        // if ($('.oldClients .clientProfile').hasClass('active')) {
        //   let x = window.scrollY + window.innerHeight
        //   console.log(x)
        //   $('.serviceList').css('max-height', `${x}px`);
        // }
        $(".serviceList").removeClass("non-active");
        // let serviceType = e.target.getAttribute('data-service')
        // let serviceCate = e.target.getAttribute('data-service-cate')
        let setheight = $(".page").height();
        $(".bookingLoad:not(.loaded):first").addClass("loaded");
        // $('.oldClients').addClass('non-active')
        $(".serviceList .mobileBottom1").addClass("active");
        $(".serviceList").css("max-height", `${setheight}px`);
        $(".serviceList .mobileBottom1 .backButton").on("click", function () {
            if (!$(".serviceList .gokutest").hasClass("non-active")) {
                total = "";
                duration = "";
                startTime = "";
                multiService = [];
                bookedStylist = "";
                serviceEnd1 = [];
                totalTime = 0;
                $(".serviceList").css("max-height", `0px`);
                $(".list-item").remove();
                $(".page-button").removeClass("page-button1");
                $(".page-test").removeClass("brand-add");
                $(".page-test").css("max-height", "0px");
                $(".list-mens").removeClass("non-active");
                $(".total").removeClass("active");
                $(".total .price").empty();
            }
        });
        $(".serviceList .desktopBottom .oldBack").on("click", function () {
            const group = $(".serviceList").find(".list-services.non-active");
            $(".loader2").removeClass("non-active");
            if ($(".serviceList .bookingForm").hasClass("active")) {
                $(".multiServiceDesk1 .serviceBooking").scrollTop(0);
                $(".serviceList .bookingForm").remove();
                $(".serviceList .serviceBookingSide").remove();
                Array.from($(".gokutest").children()).forEach((item) => {
                    $(item).css("display", "");
                });
            } else if (group.length < 3) {
                console.log("serviceList");
                $(".serviceList").css("max-height", "0px");
                $(".oldClients").removeClass("active");
                $(".newClients").removeClass("non-active");
                $(".squareupLogin").removeClass("active");
                $(".oldClientsLogin").removeClass("active");
            } else if ($(".serviceList .staffBooking").hasClass("active")) {
                console.log("staff");
                currMonth = new Date().getMonth();
                $(".multiServiceDesk1 .staffBooking").remove();
                $(".serviceList .staffBooking").removeClass("active");
                $(".serviceList .list-mens").removeClass("non-active");
                $(".loader2").addClass("non-active");
                $(".multiServiceItem .trash").removeClass("non-active");
                $(".mobileBottom1 .desktopBottom .next").removeClass("non-active");
            } else if ($(".serviceList .desktopConfirmation").hasClass("active")) {
                console.log("confirmed");
                $(".serviceList .desktopConfirmation").remove();
                $(".serviceList .multiServiceDesk").removeClass("non-active");
                Array.from($(".gokutest").children()).forEach((item) => {
                    $(item).css("display", "");
                });
                $(".loader2").addClass("non-active");
                $(".bookBut").removeClass("active3");
            } else if ($(".serviceList .serviceBooking").hasClass("active")) {
                currMonth = new Date().getMonth();

                $(".multiServiceDesk1 .serviceBooking").remove();

                $(".serviceList .staffBooking").addClass("active");
            } else if (!$(".serviceList .list-services").hasClass("non-active")) {
                currMonth = new Date().getMonth();

                duration = "";
                startTime = "";
                multiService = [];
                bookedStylist = "";
                serviceEnd1 = [];
                totalTime = 0;
                $(".oldClients").removeClass("active");
                $(".newClients").removeClass("non-active");
                $(".serviceList").css("max-height", `0px`);
                $(".serviceList .multiServiceSide").remove();
                $(".multiServiceItem").remove();
                $(".list-item").remove();
                $(".page-button").removeClass("page-button1");
                $(".page-test").removeClass("brand-add");
                $(".page-test").css("max-height", "0px");
                $(".list-mens").removeClass("non-active");
                $(".loader2").addClass("non-active");
            }
        });
        $(".serviceList .desktopBottom .oldCancel").on("click", function () {
            $(".loader2").removeClass("non-active");
            $(".oldClients .squareupLogin").removeClass("active");
            duration = "";
            startTime = "";
            multiService = [];
            bookedStylist = "";
            serviceEnd1 = [];
            totalTime = 0;

            $(".serviceList").css("max-height", `0px`);
            $(".serviceList .multiServiceSide").remove();
            $(".multiServiceItem").remove();
            $(".list-item").remove();
            $(".page-button").removeClass("page-button1");
            $(".page-test").removeClass("brand-add");
            $(".page-test").css("max-height", "0px");
            $(".list-mens").removeClass("non-active");
            $(".multiServiceDesk1 .staffBooking").addClass("active");
            $(".multiServiceDesk1 .serviceBooking").remove();
            $(".multiServiceDesk1 .staffBooking").remove();
            $(".oldClients").removeClass("active");
            $(".newClients").removeClass("non-active");
            $(".oldClients .oldClientsLogin").removeClass("active");
            if ($(".gokutest .bookingForm").hasClass("active")) {
                $(".gokutest .bookingForm").remove();
                Array.from($(".gokutest").children()).forEach((item) => {
                    $(item).css("display", "");
                });
            }
        });
        $(".serviceList .multiServiceDesk .multiServiceSide").remove();
        $(".serviceList .multiServiceDesk").prepend($(".multiServiceSide").eq(0).clone().addClass("active"));
        if (!$(".oldClients .clientProfile").hasClass("active")) {
            $(".serviceList .top-list .item").removeClass("active");
        }
        let selected = $(".serviceList .top-list").find(`:contains('${serviceType}')`);
        fetch(`https://shp-webserver-temp.glitch.me/sq-servicetype`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
        })
            .then((r) => r.json())
            .then((r) => {
                servicesAvailable = r.items;
                const vidu = r.items.filter((item) => item.itemData.categoryId == serviceCate);

                //SANDBOX
                var testing1 = new Promise((resolve, reject) => {
                    servicesAvailable.forEach((item) => {
                        let product = item.itemData.variations[0];
                        const id = product.id;
                        const categoryId = item.itemData.categoryId;
                        const mins = product.itemVariationData.serviceDuration;
                        let cost = "";
                        cost = product.itemVariationData.priceMoney ? (product.itemVariationData.priceMoney.amount / 100).toLocaleString("en-us", { style: "currency", currency: "USD" }) : "Price Varies";
                        // PRODUCTION LEVEL
                        //
                        if (categoryId == "C2IRZ4FGQXXHRF4IPAE4FEPI") {
                            $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "CTXTZZ5QEK66V6KFEK5W5CM2" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }else if (categoryId == "SBORZO5HJQ44HNVSJCBAPJQP" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }else if (categoryId == "NYEURUEDOMZVW7EWSZHQVA35" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }else if (categoryId == "AUY47YMRD5D3XWSW55R3P3UM" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }else if (categoryId == "4COPI64XBSXYW6BYVZHHV6WA" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }else if (categoryId == "HU4ALRUZQ4KW3Z5GLYCC6VO2" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }else if (categoryId == "HBPI327PFDDKGYQEPLF7NH25" ) {
                          $(`.gokutest .list-mens .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "M5DD2M3DQ32KCIYU77NK7PII" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "JIMGAKVKNKEYSBYK7XQOPP53" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "26GPWKG45J2NUC6SE3L44QGN" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "EC3GQR7MOAACVLJCCOLRN7TR" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "X24ORICP55L3LBZNID7QK2QO" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "CP5O6JJLKRVR2QQNBROJFVWT" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        } else if (categoryId == "DXXAQ46JUD7HTKAOSEQNYONU" ) {
                          $(`.gokutest .list-services .page-tab #${categoryId}`).append(`<div id="${id}" class="list-item" data-service-id="${id}">
                        <div>${item.itemData.name}</div>
                        <div>${mins / 60000}mins</div>
                        <div style="text-align:end;">${cost}</div>
                        </div>`);
                        }

            //             if (categoryId == "T7SZGAE3VBBJTJA7VF6OR6WI") {
            //                 $(".gokutest .list-mens .page-tab #installationcolor").empty().append(`<div id="${id}" class="list-item" data-service-id="${id}">
            // <div>${item.itemData.name}</div>
            // <div>${mins / 60000}mins</div>
            // <div style="text-align:end;">${cost}</div>
            // </div>`);
            //             }
            //             if (categoryId == "Q2EYMQTQ52MHZCNWAXW73S5X") {
            //                 $(".gokutest .list-mens .page-tab #maintenance").append(`<div id="${id}" class="list-item" data-service-id="${id}">
            // <div>${item.itemData.name}</div>
            // <div>${mins / 60000}mins</div>
            // <div style="text-align:end;">${cost}</div>
            // </div>`);
            //             }
            //             if (categoryId == "QUPT4I42DRU3GZHYCFCVGIRA") {
            //                 $(".gokutest .list-mens .page-tab #maintenance").append(`<div id="${id}" class="list-item" data-service-id="${id}">
            // <div>${item.itemData.name}</div>
            // <div>${mins / 60000}mins</div>
            // <div style="text-align:end;">${cost}</div>
            // </div>`);
            //             }
            //             if (categoryId == "RL64PVLSIFALWMRX4MRZGMCJ") {
            //                 $(".gokutest .list-mens .page-tab #hairtrim").empty().append(`<div id="${id}" class="list-item" data-service-id="${id}">
            // <div>${item.itemData.name}</div>
            // <div>${mins / 60000}mins</div>
            // <div style="text-align:end;">${cost}</div>
            // </div>`);
            //             }
                    });
                    resolve();
                });
                //END SANDBOX

                testing1.then(() => {
                    $(".gokutest .multiServiceDesk1 .loader2").addClass("non-active");
                    currMonth = new Date().getMonth();
                    let lastTime = new Date(currYear, currMonth + 1, 0, 23, 59, 59);
                    let currTime = date;
                    let vidu = Math.abs(lastTime - currTime) / 36e5;
                    if (vidu < 24) {
                        lastTime = new Date(currYear, currMonth + 2, 0, 23, 59, 59);
                    }
                    $(".serviceList .staffMembers .addNames1").on("click", addNames1);
                    $(".mobileBottom1 .next").addClass("non-active");
                    $(".list-services .list-item").on("click", { lastTime: lastTime, currTime: currTime, servicesAvailable: servicesAvailable }, addService);
                    $(document).on("click", ".multiServiceItem", function () {
                        // let check = $("> div:last-of-type", this).text() == "Price Varies" ?"$0.00"  : $("> div:last-of-type", this).text();
                    });
                    $(document).on("click", ".multiServiceItem .trash", function () {
                        let check = $(this).parent().find(".price")[0].innerHTML == "Price Varies" ? "$0.00" : $(this).parent().find(".price")[0].innerHTML;
                        let x = serviceEnd1.indexOf(this.id);
                        if (x > -1) {
                            serviceEnd1.splice(x, 1);
                            let self = this.id;

                            const test = servicesAvailable.filter((item1) => item1.itemData.variations[0].id == self);
                            Array.from($(".list-mens .list-item")).forEach((item) => {
                                if (this.id == item.id) {
                                    $(item).bind("click", { lastTime: lastTime, currTime: currTime, servicesAvailable: servicesAvailable }, addService);
                                }
                            });
                            checkAva(currTime, lastTime, serviceEnd1, totalTime);
                        }
                        if (serviceEnd1.length > 0) {
                            $(".mobileBottom1 .next").removeClass("non-active");
                        } else {
                            $(".mobileBottom1 .next").addClass("non-active");
                        }
                        // total = parseFloat(total) - parseFloat(check.replace(/[$,]/g, ''));
                        // $('.botss .total .price').html(`$${total}.00`);
                        $(this).parent().remove();
                        $(`.serviceList #${this.id}`).removeClass("active");
                    });
                    $(document).on("click", ".list-item.newClass", function () {
                        let check = $("> div:last-of-type", this).text() == "Price Varies" ? "$0.00" : $("> div:last-of-type", this).text();
                        let x = serviceEnd1.indexOf(this.id);
                        if (x > -1) {
                            serviceEnd1.splice(x, 1);
                            let self = this.id;

                            const test = servicesAvailable.filter((item1) => item1.itemData.variations[0].id == self);
                            totalTime -= parseInt(test[0].itemData.variations[0].itemVariationData.serviceDuration);
                            Array.from($(".list-mens .list-item")).forEach((item) => {
                                if (this.id == item.id) {
                                    $(item).bind("click", { lastTime: lastTime, currTime: currTime, servicesAvailable: servicesAvailable }, addService);
                                }
                            });
                            checkAva(currTime, lastTime, serviceEnd1, totalTime);
                        }

                        total = parseFloat(total) - parseFloat(check.replace(/[$,]/g, ""));
                        $(".botss .total .price").html(`$${total}.00`);
                        this.remove();
                        $(`.serviceList #${this.id}`).removeClass("active");
                    });

                    if (!$._data($(".mobileBottom1 .desktopBottom .next").get(0), "events")) {
                        $(".mobileBottom1 .desktopBottom .next").on("click", function () {
                            $(".multiServiceDesk1 .list-services").addClass("non-active");
                            $(".multiServiceDesk1 .list-service-title").addClass("non-active");
                            // $('.multiServiceDesk1 .staffBooking').addClass('active');

                            $(".multiServiceDesk1").append($(".staffBooking").eq(0).clone().addClass("active"));
                            $(".serviceList .staffMembers .addNames1").on("click", addNames1);
                            $(".mobileBottom1 .desktopBottom .next").addClass("non-active");
                            $(".multiServiceItem .trash").addClass("non-active");
                        });
                    }
                });
            });
        selected.addClass("active");
    }
    function addService(e) {
        let servicesAvailable = e.data.servicesAvailable;
        let currTime = e.data.currTime;
        let lastTime = e.data.lastTime;

        $(this).unbind("click");
        let serviceId = $(this).data("service-id");
        let self = this.id;
        if ($(`.botss .service #${self}`).length == 0) {
            let check = $("> div:last-of-type", this).text() == "Price Varies" ? "$0.00" : $("> div:last-of-type", this).text();
            total = parseFloat(total) + parseFloat(check.replace(/[$,]/g, ""));
            $(".botss .total .price").html(`$${total}.00`);
            if ($(".botss .total").hasClass("non-active")) {
                $(".botss .total").addClass("active");
            }
            $(".botss .service").append($(this).clone().addClass("newClass"));
            const test = servicesAvailable.filter((item1) => item1.itemData.variations[0].id == self);
            totalTime += parseInt(test[0].itemData.variations[0].itemVariationData.serviceDuration);

            if ($(".botss .service").children().length == 2) {
                $(".botss .service").css("max-height", "107px");
                $(".botss .service").css("overflow", "hidden");
            } else if ($(".botss .service").children().length > 3) {
                $(".botss .service .service-arrow").removeClass("non-active");
                $(".botss .service-arrow").on("click", function () {
                    if ($(".botss .service-arrow").hasClass("open")) {
                        $(".botss .service-arrow").css("transform", "rotate(0deg)");

                        $(".botss .service").css("max-height", "107px");
                        $(".botss .service-arrow").removeClass("open");
                    } else {
                        $(".botss .service-arrow").css("transform", "rotate(180deg)");
                        $(".botss .service").css("max-height", "unset");
                        $(".botss .service-arrow").addClass("open");
                    }
                });
            }
        }
        serviceEnd1.push(serviceId);
        if (serviceEnd1.length > 0) {
            $(".mobileBottom1 .next").removeClass("non-active");
        }
        const test = servicesAvailable.filter((item1) => item1.itemData.variations[0].id == self);
        const testName = test[0].itemData.name;
        const testDuration = test[0].itemData.variations[0].itemVariationData.serviceDuration;
        let check = $("> div:last-of-type", this).text() == "Price Varies" ? "$0.00" : $("> div:last-of-type", this).text();

        // const testPrice = test[0].itemData.variations[0].itemVariationData.priceMoney ? test[0].itemData.variations[0].itemVariationData.priceMoney.amount
        checkAva(currTime, lastTime, serviceEnd1, totalTime);
        $(".multiServiceSide .service").append(`
          <div class='multiServiceItem'>
            <span id='${serviceId}' class='trash'></span>
            <div class='name'>${testName}</div>  
            <div class='price'>${check}</div>  
            <div class='time'>${testDuration / 60000} mins</div>  
          </div>
          `);
        $(".serviceSide .serviceSideServices").append(`
          <div class='multiServiceItem'>

            <div class='name'>${testName}</div>  
            <div class='price'>${check}</div>  
            <div class='time'>${testDuration / 60000} mins</div>  
            <div class='stylist'></div>

          </div>
          `);
        $(this).hasClass("active") ? "" : $(this).addClass("active");
    }

    function backToMain() {
        $(".bookingLoad").removeClass("loaded");
        $(".mobilePopup").css("max-height", "0");
        $(".mobileMain").removeClass("active");
        $(".mobileInitial").addClass("active");
        $("#change").empty();

        currDate = date.getDate();
        currYear = date.getFullYear();
        currMonth = date.getMonth();
        test5 = new Date(currYear, currMonth + 1, 0);
        serviceEnd = "";
        serviceEnd1 = [];

        startTime = "";
        bookedStylist = "";
        stylistName = "";
        duration = "0";
        total = "0.00";
        servicesAvailable = [];
        totalTime = 0;
        multiService = [];
        calendarChange();
        $(".staffMembers .addNames1:first").addClass("loaded");
        $(".calendarTop .prev-arrow").addClass("disabled");
        $(".calendarTop .next-arrow").removeClass("disabled");
    }


    window.addEventListener("DOMContentLoaded", function () {
        $(".gtaTopSide").slick({
            dots: false,
            infinite: true,
            arrows: false,
            mobileFirst: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            autoplay: true,
            draggable: true,
            pauseOnFocus: false,
            responsive: [
                {
                    breakpoint: 1023,
                    settings: "unslick",
                },
            ],
        });
        let serviceGender = "";
        let serviceType = "";
        let color = false;
        $(".sqLogin").on("click", function () {
            $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
            $(".squareuplogin #loginForm").on("submit", checkCustomer);
            $(".squareupLogin .cancel").on("click", function () {
                $(".oldClients").addClass("non-active");
                $(".newClients").removeClass("non-active");
            });
            $(".squareupLogin .squareSignUp").on("click", function () {
                $(".oldClients").empty().append($(".squareupSignupForm").eq(0).clone().addClass("active"));
                $(".oldClients #signupForm").on("submit", { id: "#signupForm" }, createCustomer1);
            });
        });

        calendarChange();
        $(".calendarTop .next-arrow").on("click", nextMonth);
        $(".oldClients .back").on("click", function () {
            $(".oldClients").addClass("non-active");
            $(".newClients").removeClass("non-active");
        });
        fetch(`https://shp-webserver-temp.glitch.me/squareup-bookings1`, {
            method: "POST",
            headers: {
                accept: "application/json",
                "content-type": "application/json",
            },
        })
            .then((r) => r.json())
            .then((r) => {
                let ids = [];
                r.team_member_booking_profiles.forEach((item) => {
                    currentStylers.push(item);
                    ids.push(item.team_member_id);
                    $(".addNames").append(`
        <span class=display_name>${Array.from(item.display_name)[0]}</span>
        `);
                    $(".staffMembers").append(`
        
        <div data-team-member-name="${item.display_name}" data-team-member-id="${item.team_member_id}" class='bookingButton1 addNames1'>
          <span class=display_name>${Array.from(item.display_name)[0]}</span>
          <div class=salonist>${item.display_name}
            </div>
        <div class="selectDesktop">Select</div>

          </div>`);
                });
                $(".staffMembers .addNames1.loaded").attr("data-team-member-id", ids);

                stylist = ids;
                $(".staffMembers .addNames1").on("click", addNames2);
            });

        $(".buttonApt").on("click", () => {
            localStorage.removeItem("savedBooking");
            let setheight = $(".page").height();
            $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
            $(".mobileInitial").addClass("active");
            $(".mobileBottom").addClass("active");
            $(".mobilePopup").css("max-height", `${setheight}px`);
            $(".desktopBottom .newCancel").on("click", function () {
                $(".mobilePopup").css("max-height", "0px");
                $(".mobileMain").removeClass("active");
                $(".mobilePopup1 .bookingLoad.loaded").removeClass("loaded");
                $(".form123").empty();
            });
            if (!$._data($(".desktopBottom .newBack").get(0), "events")) {
                $(".desktopBottom .newBack").on("click", function () {
                    if ($(".mobileInitial").hasClass("active")) {
                        $(".mobilePopup").css("max-height", "0px");
                        $(".mobileMain").removeClass("active");
                        $(".mobilePopup1 .bookingLoad.loaded").removeClass("loaded");
                    } else if ($(".mobileService").hasClass("active")) {
                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                        $(".mobileService").removeClass("active");
                        $(".mobileInitial").addClass("active");
                    } else if ($(".mobileSystem").hasClass("active")) {
                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                        $(".mobileSystem").removeClass("active");
                        $(".mobileService").addClass("active");
                    } else if ($(".mobileService2").hasClass("active")) {
                        $(".mobileService2").removeClass("active");
                        $(".mobileSystem").addClass("active");
                    } else if ($(".mobileService3").hasClass("active")) {
                        $(".mobileService3").removeClass("active");
                        $(".mobileService2").addClass("active");
                    } else if ($(".form123 .staffBooking").hasClass("active")) {
                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                        $(".form123 .staffBooking").removeClass("active");
                        $(".mobileService3").addClass("active");
                    } else if ($(".form123 .serviceBooking").hasClass("active")) {
                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                        $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                        $(".staffMembers .addNames1").on("click", function () {
                            duration = "";
                            startTime = "";
                            multiService = [];
                            bookedStylist = "";
                            //  $('.calendarMain .loader2').removeClass('non-active')
                            $(".calendarTest .loader2").removeClass("non-active");
                            $(".morning .slot").empty();
                            $(".afternoon .slot").empty();
                            $(".evening .slot").empty();

                            if ($(".pleaseSelect").children.length > 0) {
                                $(".pleaseSelect").empty();
                            }

                            let memberId = $(this).data("team-member-id");
                            stylistName = $(this).data("team-member-name");
                            stylist = memberId.split(",");
                            $(".staffMembers .addNames1").removeClass("loaded");
                            $(this).addClass("loaded");
                            let date1 = new Date();
                            let year = date1.getFullYear();
                            let mon = date1.getMonth();
                            let test5 = new Date(year, mon + 1, 0);
                            test5.setUTCHours(23, 59, 59, 0);
                            currMonth = new Date().getMonth();
                            calendarChange();
                            bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                            serviceType1(serviceEnd, stylist);
                            if ($(window).width() > 1023) {
                                $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                                $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                                $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                                $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                                $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                                $(".form123 .calendarTop .prev-arrow").on("click", prevMonth);
                            }
                        });
                    } else if ($(".form123 .bookingForm").hasClass("active")) {
                        // $('.calendarMain .loader2').removeClass('non-active')
                        $(".calendarTest .loader2").removeClass("non-active");
                        $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                        $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                        $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                        $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                        $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                        $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                        $(".form123 .calendarTop .prev-arrow").on("click", prevMonth);
                        let date1 = new Date();
                        let year = date1.getFullYear();
                        let mon = date1.getMonth();
                        let test5 = new Date(year, mon + 1, 0);
                        test5.setUTCHours(23, 59, 59, 0);
                        currMonth = new Date().getMonth();
                        calendarChange();
                        bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                        $(".serviceSideServices .loader2").addClass("non-active");
                        $(".bookBut").on("click", function () {
                            duration = $(this).data("duration");
                            startTime = $(this).data("start-id");
                            bookedStylist = $(this).data("team-member");
                            $(".bookBut").removeClass("active3");
                            $(this).addClass("active3");
                            if ($(".pleaseSelect").children.length > 0) {
                                $(".pleaseSelect").empty();
                            }
                            if ($(window).width() > 1023) {
                                if ($(".oldClients").hasClass("non-active")) {
                                    $(".form123").scrollTop(0);

                                    serviceType1(serviceEnd, stylist, startTime);

                                    $(".form123").empty().append($(".bookingForm").eq(0).clone().addClass("active"));
                                    $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                    $(".form123 #myForm1").on("submit", submitForm);
                                } else {
                                    serviceType1(serviceEnd, stylist, startTime);
                                    $(".gokutest").empty().append($(".bookingForm").eq(0).clone().addClass("active"));
                                    $(".gokutest .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                                    // $('.serviceBookingSide .loader2').addClass('non-active')
                                    $(".gokutest #myForm1").on("submit", submitForm);
                                }
                            }
                        });
                    }
                });
            }
        });
        $(".mobileCancel").on("click", backToMain);

        $(".mobileGTA .backButton2 .backButton2").on("click", function () {
            if ($(".mobilePopup .mobileInitial").hasClass("active")) {
                backToMain();
            } else if ($(".mobilePopup .mobileService").hasClass("active")) {
                $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                $(".mobilePopup .mobileService").removeClass("active");
                $(".mobilePopup .mobileInitial").addClass("active");
            } else if ($(".mobilePopup .mobileSystem").hasClass("active")) {
                $(".mobilePopup1 .bookingLoad.loaded:last").removeClass("loaded");
                $(".mobilePopup .mobileSystem").removeClass("active");
                $(".mobilePopup .mobileService").addClass("active");
                serviceGender = "";
            } else if ($(".mobilePopup .mobileService2").hasClass("active")) {
                $(".mobilePopup .mobileService2").removeClass("active");
                $(".mobilePopup .mobileSystem").addClass("active");
            } else if ($(".mobilePop .mobileService3").hasClass("active")) {
                $(".mobilePopup .mobileService2").addClass("active");
                $(".mobilePopup .mobileService3").removeClass("active");
                serviceType = "";
            }
        });
        $("#1").on("click", () => {
            $(".mobileInitial").removeClass("active");
            $(".mobileService").addClass("active");
            $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
            $(".mobileGTA .backButton2").removeClass("non-active");
        });

        $("#2").on("click", () => {
            $(".top-list .item").on("click", function () {
                $(".top-list .item").removeClass("active");
                $(this).addClass("active");
                // console.log($(this).html())
                if ($(this).html() == "Women") {
                    $(".serviceList .list-services").addClass("non-active");
                    $(".serviceList .list-services.list-womens").removeClass("non-active");
                } else if ($(this).html() == "Men") {
                    $(".serviceList .list-services").addClass("non-active");
                    $(".serviceList .list-services.list-mens").removeClass("non-active");
                } else if ($(this).html() == "Consultation") {
                    $(".serviceList .list-services").addClass("non-active");
                    $(".serviceList .list-services.list-consult").removeClass("non-active");
                }
            });
            if ($(window).width() > 1023) {
                if (localStorage.getItem("email")) {
                    let setheight = $(".page").height();
                    $(".serviceList").css("max-height", `${setheight}px`);
                    showService();
                    $(".loggedInDesktop .para").on("click", { email: localStorage.getItem("email") }, clientInfo);
                    $(".loggedInDesktop .para1").on("click", function () {
                        console.log("Sign out");
                        localStorage.removeItem("email");
                        localStorage.removeItem("name");
                        localStorage.removeItem("lastName");
                        $(".oldClients").removeClass("active");
                        $(".oldClients").addClass("non-active");
                        $(".newClients").removeClass("non-active");
                        $(".serviceList").css("max-height", "0px");
                    });
                    $(".newClients").addClass("non-active");
                    $(".oldClients").addClass("active");
                    $(".oldClients .oldClientsLogin").removeClass("active");
                    // $('.oldClients .clientProfile')
                } else {
                    $(".oldClients").removeClass("non-active");
                    $(".newClients").addClass("non-active");
                    $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                    $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                    $(".squareupLogin #loginForm input").prop("disabled", false);
                    $(".requestButton").removeClass("loading");
                    $(".squareupLogin .cancel").on("click", function () {
                        $(".oldClients").addClass("non-active");
                        $(".newClients").removeClass("non-active");
                    });
                    $(".squareupLogin .squareSignUp").on("click", function () {
                        $(".oldClients").empty().append($(".squareupSignupForm").eq(0).clone().addClass("active"));
                        $(".oldClients #signupForm").on("submit", { id: "#signupForm" }, createCustomer1);
                    });
                    $(".squareuplogin #loginForm").on("submit", checkCustomer);
                }
                // showService()
                // let setheight = $('.page').height();
                // $('.serviceList').css('max-height', `${setheight}px`);
            } else {
                $(".newClients").addClass("non-active");
                $(".oldClients").removeClass("non-active");
            }
            $(".bookingLoad").removeClass("loaded");
            $(".mobilePopup").css("max-height", "0");
            // $('.mobileMain').removeClass('active');

            if (localStorage.getItem("email")) {
                $(".oldClients").empty().append($(".oldClientsLogin").eq(0).clone().addClass("active"));
                $(".oldClientsLogin .signIn_square .block").addClass("non-active");
                $(".oldClientsLogin .myAppts").addClass("active");
                $(".oldClientsLogin .myAppts .newName").empty().append(localStorage.getItem("name"));
                $(".oldClientsLogin .myAppts button").on("click", { email: localStorage.getItem("email") }, clientInfo);
                $(".oldClients .back2").on("click", function () {
                    $(".oldClients").addClass("non-active");
                    $(".newClients").removeClass("non-active");
                });
                $(".oldClients .myAppts div").on("click", function () {
                    localStorage.removeItem("email");
                    localStorage.removeItem("name");
                    localStorage.removeItem("lastName");

                    $(".oldClientsLogin .signIn_square .block").removeClass("non-active");
                    $(".oldClientsLogin .myAppts").removeClass("active");
                    $(".oldClientsLogin .signIn_square .sqLogin").on("click", function () {
                        $(".oldClients").empty().append($(".squareupLogin").eq(0).clone().addClass("active"));
                        $(".squareupLogin #loginForm .requestButton").removeClass("loading");
                        $(".squareupLogin #loginForm input").prop("disabled", false);
                        $(".requestButton").removeClass("loading");

                        $(".squareuplogin #loginForm").on("submit", checkCustomer);
                    });
                });
                // console.log(localStorage.getItem('email'))
            } else {
                // console.log(localStorage.getItem('email'))
            }
            if (!$._data($(".oldClients .button2").get(0), "events")) {
                $(".oldClients .button2").on("click", showService);
            }
        });
        $(".mobileService .bookingButton1").on("click", (e) => {
            e.preventDefault();
            serviceGender = e.target.id;
            if (serviceGender == "mens" || serviceGender == "womens") {
                $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                $(".mobileService").removeClass("active");
                $(".mobileSystem").addClass("active");
            } else {
                $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                $(".mobileService").removeClass("active");
                $(".mobileSystem2").addClass("active");
                $(".mobileSystem2 #no").on("click", function () {
                    var a = document.createElement("a");
                    a.target = "_blank";
                    a.href = "/online-professional-hair-consultant-for-hair-pieces-toupee/";
                    a.click();
                });
                $(".mobileSystem2 #yes").on("click", function () {
                    $(".mobileSystem2").removeClass("active");
                    $(".mobileSystem3").addClass("active");
                    $('.mobileSystem3 button').on("click", function() {
                      $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                        $(".mobileSystem3").removeClass("active");
                        if ($(window).width() > 1023) {
                            $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                        } else {
                            $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                            $(".form123").append($(".serviceBooking").eq(0).clone().addClass("active"));
                            $(".form123 .serviceBooking").addClass("active");
                        }
                        $(".staffMembers .addNames1").on("click", addNames3);
                        $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                        $(".mobileBottom").removeClass("active");
                        if ($(window).width() > 1023) {
                            if ($(".newClients").hasClass("non-active")) {
                                $(".mobileBottom1").addClass("active");
                            }
                        } else {
                            $(".mobileBottom1").addClass("active");
                        }
                      if (this.id == 'mens') {
                        bookingSq(date.toISOString(), test5.toISOString(), ["EJOFRYTXG4AZTMA5VRQIJ6EY"], stylist);
                      } else {
                        bookingSq(date.toISOString(), test5.toISOString(), ["N5VFZOSNAOP7RCKAR5VMDDUZ"], stylist);
                      }
                    })
                });
            }
        });

        $("#systemYes").on("click", () => {
            $(".mobileSystem").removeClass("active");
            $(".mobileService2").addClass("active");
        });
        $("#systemBuy").on("click", () => {
            if (serviceGender == "mens") {
                var a = document.createElement("a");
                a.target = "_blank";
                a.href = "/men-hair-pieces-toupees/";
                a.click();
            } else {
                var a = document.createElement("a");
                a.target = "_blank";
                a.href = "/womens-hair-pieces-toppers-wigs/";
                a.click();
            }
            // $('.mobileSystem').removeClass('active');
            // $('.mobileService2').addClass('active');
        });

        ///////////////////////////////////////////////////
        $(".mobileService2 .bookingButton").on("click", (e) => {
            e.preventDefault();
            serviceType = e.target.id;
            if (serviceType == "Installation" || serviceType == "Maintenance") {
                $(".mobileService2").removeClass("active");
                $(".mobileService3").addClass("active");
                $("#change").empty().append(`
        (${serviceType} + color) 
      `);
            } else if (serviceType == "serviceCons") {

                    $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                    $(".mobileService2").removeClass("active");
                    if ($(window).width() > 1023) {
                        $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                    } else {
                        $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                        $(".form123").append($(".serviceBooking").eq(0).clone().addClass("active"));
                        $(".form123 .serviceBooking").addClass("active");
                    }
                    $(".staffMembers .addNames1").on("click", addNames3);
                    $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                    $(".mobileBottom").removeClass("active");
                    if ($(window).width() > 1023) {
                        if ($(".newClients").hasClass("non-active")) {
                            $(".mobileBottom1").addClass("active");
                        }
                    } else {
                        $(".mobileBottom1").addClass("active");
                    }
                if (serviceGender == "mens") {
                    bookingSq(date.toISOString(), test5.toISOString(), ["EJOFRYTXG4AZTMA5VRQIJ6EY"], stylist);
                } else if (serviceGender == 'womens') {
                  bookingSq(date.toISOString(), test5.toISOString(), ["N5VFZOSNAOP7RCKAR5VMDDUZ"], stylist);
                }
            }
        });
        /////
        $(".mobileService3 .bookingButton").on("click", (e) => {
            e.preventDefault();
            e.target.innerHTML == "Yes" ? (color = true) : (color = false);
            $(".mobileService3").removeClass("active");
            if ($(window).width() > 1023) {
                $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
            } else {
                $(".form123").empty().append($(".staffBooking").eq(0).clone().addClass("active"));
                $(".form123").append($(".serviceBooking").eq(0).clone().addClass("active"));

                $(".form123 .serviceBooking").addClass("active");
            }

            $(".staffMembers .addNames1").on("click", function () {
                if ($(window).width() > 1023) {
                    $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
                }
                duration = "";
                startTime = "";
                multiService = [];
                bookedStylist = "";
                // $('.calendarMain .loader2').removeClass('non-active')
                $(".calendarTest .loader2").removeClass("non-active");
                $(".morning .slot").empty();
                $(".afternoon .slot").empty();
                $(".evening .slot").empty();

                if ($(".pleaseSelect").children.length > 0) {
                    $(".pleaseSelect").empty();
                }
                let memberId = $(this).data("team-member-id");
                stylistName = $(this).data("team-member-name");
                stylist = memberId.split(",");
                $(".staffMembers .addNames1").removeClass("loaded");
                $(this).addClass("loaded");
                currMonth = new Date().getMonth();
                let date1 = new Date();
                let year = date1.getFullYear();
                let mon = date1.getMonth();
                let test5 = new Date(year, mon + 1, 0);
                test5.setUTCHours(23, 59, 59, 0);
                calendarChange();
                bookingSq(date1.toISOString(), test5.toISOString(), serviceEnd, stylist);
                $(".form123 .calendarTop .next-arrow").removeClass("disabled");
                $(".form123 .calendarTop .prev-arrow").addClass("disabled");
                if ($(window).width() > 1023) {
                    serviceType1(serviceEnd, stylist);

                    $(".form123").empty().append($(".serviceBooking").eq(0).clone().addClass("active"));
                    $(".form123 .serviceBookingSide").empty().append($(".serviceSide").eq(0).clone().addClass("active"));
                    $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
                }
            });

            $(".form123 .calendarTop .next-arrow").on("click", nextMonth);
            $(".mobileBottom").removeClass("active");
            if ($(window).width() > 1023) {
                if ($(".newClients").hasClass("non-active")) {
                    $(".mobileBottom1").addClass("active");
                }
            } else {
                $(".mobileBottom1").addClass("active");
            }

            $(".mobilePopup1 .bookingLoad:not(.loaded):first").addClass("loaded");
            if ($(window).width() > 1023) {
            }
            if (serviceGender == "mens") {
                if (serviceType == "Maintenance") {
                    if (color) {
                        bookingSq(date.toISOString(), test5.toISOString(), ["3WRDXUMI7MXEBFIEJQ3WZVXQ"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    } else {
                        bookingSq(date.toISOString(), test5.toISOString(), ["Q3GP2KCQNTC5LESEALDKJBDC"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    }
                } else {
                    if (color) {
                        bookingSq(date.toISOString(), test5.toISOString(), ["Q3GP2KCQNTC5LESEALDKJBDC"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    } else {
                        bookingSq(date.toISOString(), test5.toISOString(), ["3WRDXUMI7MXEBFIEJQ3WZVXQ"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    }
                }
            } else {
                if (serviceType == "Maintenance") {
                    if (color) {
                        bookingSq(date.toISOString(), test5.toISOString(), ["A63SLKGS53GPCXBNOMBCMAQA"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    } else {
                        bookingSq(date.toISOString(), test5.toISOString(), ["WTRFAPG5ORECMGHCNRSCVR36"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    }
                } else {
                    if (color) {
                        bookingSq(date.toISOString(), test5.toISOString(), ["DR6GFFRRQR42R2GN5YNIW6UL"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    } else {
                        bookingSq(date.toISOString(), test5.toISOString(), ["33GH64PSSVWSSY5PIHUUQJAA"], stylist);
                        if (stylistName) {
                            $(".form123 .staffMembers").find(`[data-team-member-name='${stylistName}']`).addClass("loaded");
                        }
                    }
                }
            }
        });
    });
</script>